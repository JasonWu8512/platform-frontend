{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/testTools/apolloNotify.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/testTools/apolloNotify.vue","mtime":1657270292207},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB2YXJpYWJsZXMgZnJvbSAiQC9hc3NldHMvY3NzL3V0aWxzLnNjc3MiCmltcG9ydCB7ZGF0YVRvb2xBcGl9IGZyb20gIkAvYXBpIjsKaW1wb3J0IHtjbG9uZURlZXB9IGZyb20gImxvZGFzaCIKaW1wb3J0IFRhYmxlT3BlcmF0b3IgZnJvbSAiQC9jb21tb24vY29tcG9uZW50cy9UYWJsZU9wZXJhdG9yIjsKaW1wb3J0IFRhYmxlSGVhZGVyIGZyb20gIkAvY29tbW9uL2NvbXBvbmVudHMvVGFibGVIZWFkZXIiOwppbXBvcnQgVGFibGVQYWdpbmF0aW9uIGZyb20gIkAvY29tbW9uL2NvbXBvbmVudHMvcGFnaW5hdGlvbi9UYWJsZVBhZ2luYXRpb24iOwppbXBvcnQgRGlhbG9nRm9vdGVyIGZyb20gIkAvY29tbW9uL2NvbXBvbmVudHMvRGlhbG9nRm9vdGVyIjsKaW1wb3J0IHtvcGVyYXRpb25FbnVtfSBmcm9tICJAL2NvbnN0YW50L0dpdGxhYiI7CmltcG9ydCB7UEFHSU5BVElPTl9TSVpFfSBmcm9tICJAL2NvbnN0YW50IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJhcG9sbG9Ob3RpZnkiLAogIGNvbXBvbmVudHM6IHsKICAgIFRhYmxlT3BlcmF0b3IsCiAgICBUYWJsZUhlYWRlciwKICAgIFRhYmxlUGFnaW5hdGlvbiwKICAgIERpYWxvZ0Zvb3RlciwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBvcGVyYXRpb25FbnVtOiBvcGVyYXRpb25FbnVtLAogICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgIGNvbmRpdGlvbjoge30sCiAgICAgIG9wZXJhdGlvbjogJycsCiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIGN1cnJlbnRQYWdlOiAxLAogICAgICBwYWdlU2l6ZTogUEFHSU5BVElPTl9TSVpFLkxBUkdFLAogICAgICB0b3RhbDogMCwKICAgICAgYXBwT3B0aW9uczogW10sCiAgICAgIGFwcENoYXRGb3JtOnsKICAgICAgICBhcHBJZDogJycsCiAgICAgICAgY2hhdElkOiAnJwogICAgICB9LAogICAgICBhcHBDaGF0UnVsZXM6IHsKICAgICAgICBhcHBJZDogW3tyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqeW6lOeUqCcsIHRyaWdnZXI6ICdibHVyJ31dLAogICAgICAgIGNoYXRJZDogW3tyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqemAmuefpee+pOiBiicsIHRyaWdnZXI6ICdibHVyJ31dLAogICAgICB9CiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgZm9ybUxhYmVsV2lkdGgoKSB7CiAgICAgIHJldHVybiB2YXJpYWJsZXNbJ2Zvcm1MYWJlbFdpZHRoJ10KICAgIH0sCiAgICBsb2FkaW5nKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUubG9hZGluZwogICAgfSwKICAgIGNoYXRPcHRpb25zKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuY292ZXJhZ2UubGFya0NoYXRzCiAgICB9LAogICAgdGFibGUyQnRuV2lkdGgoKSB7CiAgICAgIHJldHVybiB2YXJpYWJsZXNbJ3RhYmxlMkJ0bldpZHRoJ10KICAgIH0sCgogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0QWxsQXBwcygpCiAgICB0aGlzLmdldFRhYmxlRGF0YSgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRBbGxBcHBzKCkgewogICAgICBkYXRhVG9vbEFwaS5nZXRBcG9sbG9BcHBzKCkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMuYXBwT3B0aW9ucyA9IHJlcy5kYXRhCiAgICAgIH0pCiAgICB9LAogICAgb3BlbkVkaXQocm93KSB7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSB0cnVlCiAgICAgIHRoaXMub3BlcmF0aW9uID0gb3BlcmF0aW9uRW51bS5BREQKICAgICAgdGhpcy5hcHBDaGF0Rm9ybSA9IHsKICAgICAgICBhcHBJZDogJycsCiAgICAgICAgY2hhdElkOiAnJwogICAgICB9CiAgICAgIGlmIChyb3cpIHsKICAgICAgICB0aGlzLm9wZXJhdGlvbiA9IG9wZXJhdGlvbkVudW0uRURJVAogICAgICAgIHRoaXMuYXBwQ2hhdEZvcm0gPSBjbG9uZURlZXAocm93KQogICAgICB9CiAgICB9LAogICAgZ2V0VGFibGVEYXRhKHZhbHVlKSB7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgICBvZmZzZXQ6IHRoaXMucGFnZVNpemUgKiAodGhpcy5jdXJyZW50UGFnZSAtIDEpLAogICAgICAgIGxpbWl0OiB0aGlzLnBhZ2VTaXplLAogICAgICAgIHNlYXJjaDogdmFsdWUgPyB2YWx1ZSA6ICcnCiAgICAgIH0KICAgICAgZGF0YVRvb2xBcGkuZ2V0QXBvbGxvQXBwQ2hhdChwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLnRhYmxlRGF0YSA9IHJlcy5kYXRhLmRhdGEKICAgICAgICB0aGlzLnRvdGFsID0gcmVzLmRhdGEudG90YWwKICAgICAgfSkKICAgIH0sCiAgICBzYXZlQ29uZmlnKCkgewogICAgICBpZiAodGhpcy5vcGVyYXRpb24gPT09IG9wZXJhdGlvbkVudW0uQUREKXsKICAgICAgICBkYXRhVG9vbEFwaS5jcmVhdGVBcG9sbG9BcHBDaGF0KHRoaXMuYXBwQ2hhdEZvcm0pLmZpbmFsbHkoKCkgPT4gewogICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICB0aGlzLmdldFRhYmxlRGF0YSgpCiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICBkYXRhVG9vbEFwaS51cGRhdGVBcG9sbG9BcHBDaGF0KHRoaXMuYXBwQ2hhdEZvcm0sIHRoaXMuYXBwQ2hhdEZvcm1bJ2lkJ10pLmZpbmFsbHkoKCkgPT4gewogICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICB0aGlzLmdldFRhYmxlRGF0YSgpCiAgICAgICAgfSkKICAgICAgfQogICAgfSwKICAgIGhhbmRsZWRlbGV0ZShyb3cpIHsKICAgICAgdGhpcy4kYWxlcnQoJ+ehruiupOWIoOmZpOivpemFjee9rj8nLCAnJywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIGNhbGxiYWNrOiAoYWN0aW9uKSA9PiB7CiAgICAgICAgICBpZiAoYWN0aW9uID09PSAnY29uZmlybScpIHsKICAgICAgICAgICAgZGF0YVRvb2xBcGkuZGVsZXRlQXBvbGxvQXBwQ2hhdChyb3cuaWQpCiAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5nZXRUYWJsZURhdGEoKQogICAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGhhbmRsZVNlYXJjaCh2YWx1ZSkgewogICAgICB0aGlzLmN1cnJlbnRQYWdlID0gMQogICAgICB0aGlzLmdldFRhYmxlRGF0YSh2YWx1ZSkKICAgIH0KCiAgfQp9Cg=="},{"version":3,"sources":["apolloNotify.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"apolloNotify.vue","sourceRoot":"src/pages/testTools","sourcesContent":["<template>\n  <div>\n    <el-card class=\"card-content\">\n      <template slot=\"header\">\n        <table-header\n          :condition=\"condition\"\n          create-tip=\"apollo通知配置-国内\"\n          placeholder=\"根据项目名称搜索\"\n          @create=\"openEdit\"\n          @search=\"handleSearch\"\n        >\n          <template slot=\"title\">\n            <div>apollo通知配置-国内</div>\n          </template>\n        </table-header>\n      </template>\n      <el-table ref=\"table\" v-loading=\"loading\" :data=\"tableData\">\n\n        <!--  项目名称  -->\n        <el-table-column label=\"应用\" prop=\"appId\"/>\n\n        <!--  群聊  -->\n        <el-table-column label=\"群聊\" prop=\"chatName\"/>\n\n        <!--  操作  -->\n        <el-table-column :width=\"table2BtnWidth\" label=\"操作\">\n          <template slot-scope=\"scope\">\n            <table-operator\n              show-delete\n              show-edit\n              @deleteClick=\"handledelete(scope.row)\"\n              @editClick=\"openEdit(scope.row)\"\n            />\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <table-pagination\n        :change=\"getTableData\"\n        :current-page.sync=\"currentPage\"\n        :page-size.sync=\"pageSize\"\n        :total=\"total\"\n      />\n    </el-card>\n\n    <el-dialog\n      :close-on-click-modal=\"false\"\n      :visible.sync=\"dialogFormVisible\"\n      class=\"dialog-title\"\n      width=\"65%\"\n    >\n      <template slot=\"title\">\n        <div style=\"text-align: left;\">\n          <span>{{ operation === operationEnum.EDIT? '编辑apollo通知配置' : '创建apollo通知配置' }}</span>\n        </div>\n        <el-divider style=\"width: 100%;\"></el-divider>\n      </template>\n\n      <el-form ref=\"apolloNotifyForm\" :model=\"appChatForm\" :rules=\"appChatRules\" :label-width=\"formLabelWidth\">\n        <el-row>\n          <el-col :offset=\"1\" :span=\"10\">\n            <el-form-item label=\"应用\" prop=\"appId\">\n              <el-select v-model=\"appChatForm.appId\" filterable placeholder=\"请选择应用\" style=\"width: 100%\">\n                <el-option\n                  v-for=\"item in appOptions\"\n                  :key=\"item.id\"\n                  :label=\"item.appId\"\n                  :value=\"item.appId\"\n                />\n              </el-select>\n            </el-form-item>\n          </el-col>\n\n          <el-col :span=\"10\">\n            <el-form-item label=\"推送群聊\" prop=\"chatId\">\n              <el-select\n                v-model=\"appChatForm.chatId\"\n                filterable\n                placeholder=\"请选择需要通知的群\"\n                style=\"width: 100%;\"\n              >\n                <el-option\n                  v-for=\"item in chatOptions\"\n                  :key=\"item.chatId\"\n                  :label=\"item.name\"\n                  :value=\"item.chatId\"\n                />\n              </el-select>\n            </el-form-item>\n          </el-col>\n        </el-row>\n      </el-form>\n\n      <template slot=\"footer\">\n        <dialog-footer @cancel=\"dialogFormVisible = false\" @confirm=\"saveConfig\"/>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport variables from \"@/assets/css/utils.scss\"\nimport {dataToolApi} from \"@/api\";\nimport {cloneDeep} from \"lodash\"\nimport TableOperator from \"@/common/components/TableOperator\";\nimport TableHeader from \"@/common/components/TableHeader\";\nimport TablePagination from \"@/common/components/pagination/TablePagination\";\nimport DialogFooter from \"@/common/components/DialogFooter\";\nimport {operationEnum} from \"@/constant/Gitlab\";\nimport {PAGINATION_SIZE} from \"@/constant\";\nexport default {\n  name: \"apolloNotify\",\n  components: {\n    TableOperator,\n    TableHeader,\n    TablePagination,\n    DialogFooter,\n  },\n  data() {\n    return {\n      operationEnum: operationEnum,\n      dialogFormVisible: false,\n      condition: {},\n      operation: '',\n      tableData: [],\n      currentPage: 1,\n      pageSize: PAGINATION_SIZE.LARGE,\n      total: 0,\n      appOptions: [],\n      appChatForm:{\n        appId: '',\n        chatId: ''\n      },\n      appChatRules: {\n        appId: [{required: true, message: '请选择应用', trigger: 'blur'}],\n        chatId: [{required: true, message: '请选择通知群聊', trigger: 'blur'}],\n      }\n    }\n  },\n  computed: {\n    formLabelWidth() {\n      return variables['formLabelWidth']\n    },\n    loading() {\n      return this.$store.state.loading\n    },\n    chatOptions() {\n      return this.$store.state.coverage.larkChats\n    },\n    table2BtnWidth() {\n      return variables['table2BtnWidth']\n    },\n\n  },\n  mounted() {\n    this.getAllApps()\n    this.getTableData()\n  },\n  methods: {\n    getAllApps() {\n      dataToolApi.getApolloApps().then(res => {\n        this.appOptions = res.data\n      })\n    },\n    openEdit(row) {\n      this.dialogFormVisible = true\n      this.operation = operationEnum.ADD\n      this.appChatForm = {\n        appId: '',\n        chatId: ''\n      }\n      if (row) {\n        this.operation = operationEnum.EDIT\n        this.appChatForm = cloneDeep(row)\n      }\n    },\n    getTableData(value) {\n      const params = {\n        offset: this.pageSize * (this.currentPage - 1),\n        limit: this.pageSize,\n        search: value ? value : ''\n      }\n      dataToolApi.getApolloAppChat(params).then(res => {\n        this.tableData = res.data.data\n        this.total = res.data.total\n      })\n    },\n    saveConfig() {\n      if (this.operation === operationEnum.ADD){\n        dataToolApi.createApolloAppChat(this.appChatForm).finally(() => {\n          this.dialogFormVisible = false\n          this.getTableData()\n        })\n      } else {\n        dataToolApi.updateApolloAppChat(this.appChatForm, this.appChatForm['id']).finally(() => {\n          this.dialogFormVisible = false\n          this.getTableData()\n        })\n      }\n    },\n    handledelete(row) {\n      this.$alert('确认删除该配置?', '', {\n        confirmButtonText: '确定',\n        showCancelButton: true,\n        cancelButtonText: '取消',\n        callback: (action) => {\n          if (action === 'confirm') {\n            dataToolApi.deleteApolloAppChat(row.id)\n              .then(() => {\n                this.getTableData()\n              })\n          }\n        }\n      })\n    },\n    handleSearch(value) {\n      this.currentPage = 1\n      this.getTableData(value)\n    }\n\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}