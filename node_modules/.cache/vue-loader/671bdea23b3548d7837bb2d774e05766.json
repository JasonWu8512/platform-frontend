{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/track/review/components/TestCaseReviewEdit.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/track/review/components/TestCaseReviewEdit.vue","mtime":1655949681807},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/ts-loader/index.js","mtime":1644314987889},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IHt0ZXN0UmV2aWV3QXBpfSBmcm9tICJAL2FwaSIKaW1wb3J0IHtSZXF1ZXN0VXBkYXRlVGVzdENhc2VSZXZpZXd9IGZyb20gIkAvYXBpL3R5cGVzL3Rlc3RSZXZpZXciCmltcG9ydCB7dHlwZVJldmlld0RhdGF9IGZyb20gIkAvYXBpL3R5cGVzL3Rlc3RSZXZpZXdUeXBlIgppbXBvcnQgdmFyaWFibGVzIGZyb20gIkAvYXNzZXRzL2Nzcy91dGlscy5zY3NzIgppbXBvcnQgRGlhbG9nRm9vdGVyIGZyb20gIkAvY29tbW9uL2NvbXBvbmVudHMvRGlhbG9nRm9vdGVyLnZ1ZSIKaW1wb3J0IHtkYXRlUGlja2VyT3B0aW9uc1N0YXJ0fSBmcm9tICJAL2NvbW1vbi91dGlscyIKaW1wb3J0IHtvcGVyYXRpb25FbnVtfSBmcm9tICJAL2NvbnN0YW50L1Rlc3RDYXNlIgppbXBvcnQge3Jldmlld1N0YXR1c0VudW19IGZyb20gIkAvY29uc3RhbnQvVGVzdFJlaXZldyIKaW1wb3J0IFRlc3RSZXZpZXdTdGF0dXNCdXR0b24gZnJvbSAiQC9wYWdlcy90cmFjay9yZXZpZXcvY29tbW9tL1Rlc3RSZXZpZXdTdGF0dXNCdXR0b24udnVlIgppbXBvcnQge3Jldmlld0Zvcm0sIHJldmlld0Zvcm1SdWxlc30gZnJvbSAiQC9wYWdlcy90cmFjay9yZXZpZXcvZm9ybXMiCmltcG9ydCB7Y2xvbmVEZWVwfSBmcm9tICJsb2Rhc2giCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlRlc3RDYXNlUmV2aWV3RWRpdCIsCiAgY29tcG9uZW50czoge0RpYWxvZ0Zvb3RlciwgVGVzdFJldmlld1N0YXR1c0J1dHRvbn0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9wZXJhdGlvbkVudW06IG9wZXJhdGlvbkVudW0sCiAgICAgIHByb2plY3RzOiB0aGlzLnByb2plY3RzLAogICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgIGZvcm06IHJldmlld0Zvcm0sCiAgICAgIHJ1bGVzOiByZXZpZXdGb3JtUnVsZXMsCiAgICAgIG9wZXJhdGlvbjogJycsCiAgICAgIHJldmlld2VyT3B0aW9uczogW10sCiAgICAgIHBpY2tlck9wdGlvbnNTdGFydDoge30sCiAgICB9CiAgfSwKICBwcm9wczogewogICAgY29uZGl0aW9uOiBPYmplY3QsCiAgfSwKICBpbmplY3Q6IFsncHJvamVjdHMnXSwKICBjb21wdXRlZDogewogICAgZm9ybUxhYmVsV2lkdGgoKSB7CiAgICAgIHJldHVybiB2YXJpYWJsZXNbJ2Zvcm1MYWJlbFdpZHRoJ10KICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy4kZXZlbnRCdXMuJG9uKCJjYXNlUmV2aWV3RWRpdCIsIChjYXNlUmV2aWV3OiB0eXBlUmV2aWV3RGF0YSkgPT4gewogICAgICB0aGlzLm9wZW4oY2FzZVJldmlldykKICAgIH0pCiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0T3B0aW9ucygpIHsKICAgICAgdGhpcy5yZXZpZXdlck9wdGlvbnMgPSB0aGlzLmNvbmRpdGlvbi5yZXZpZXdlck9wdGlvbnMKICAgIH0sCiAgICBpbml0RGF0ZU9wdGlvbnMoKSB7CiAgICAgIHRoaXMucGlja2VyT3B0aW9uc1N0YXJ0ID0gZGF0ZVBpY2tlck9wdGlvbnNTdGFydCgpCiAgICB9LAogICAgb3BlbihjYXNlUmV2aWV3OiB0eXBlUmV2aWV3RGF0YSkgewogICAgICB0aGlzLmluaXRPcHRpb25zKCkKICAgICAgdGhpcy5pbml0RGF0ZU9wdGlvbnMoKQogICAgICAvL+S/ruaUuQogICAgICBpZiAoY2FzZVJldmlldykgewogICAgICAgIHRoaXMuZm9ybSA9IGNsb25lRGVlcChjYXNlUmV2aWV3KQogICAgICAgIHRoaXMub3BlcmF0aW9uID0gb3BlcmF0aW9uRW51bS5FRElUCiAgICAgIH0KICAgICAgLy8gY29uc29sZS5sb2codGhpcy5mb3JtKQogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZQogICAgfSwKICAgIHNhdmVSZXZpZXcoKSB7CiAgICAgIHRoaXMuJHJlZnNbJ3Jldmlld0Zvcm0nXS52YWxpZGF0ZSgodmFsaWQ6IGJvb2xlYW4pID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGxldCByZXZpZXdCb2R5OiBSZXF1ZXN0VXBkYXRlVGVzdENhc2VSZXZpZXcgPSB7CiAgICAgICAgICAgIG5hbWU6IHRoaXMuZm9ybS5uYW1lLAogICAgICAgICAgICB0YXJnZXRFbmQ6IHRoaXMuZm9ybS50YXJnZXRFbmQgfHwgbnVsbCwKICAgICAgICAgICAgcmV2aWV3ZXI6IHRoaXMuZm9ybS5yZXZpZXdlckxpc3QsCiAgICAgICAgICAgIHN0YXR1czogdGhpcy5mb3JtLnN0YXR1cywKICAgICAgICAgIH0KICAgICAgICAgIHRlc3RSZXZpZXdBcGkudXBkYXRlVGVzdENhc2VSZXZpZXcodGhpcy5mb3JtLmlkLCByZXZpZXdCb2R5KQogICAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kZW1pdCgicmVmcmVzaCIpCiAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpCiAgICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIHN0YXR1c0NoYW5nZShzdGF0dXM6IHJldmlld1N0YXR1c0VudW0pIHsKICAgICAgdGhpcy5mb3JtLnN0YXR1cyA9IHN0YXR1cwogICAgICB0aGlzLiRmb3JjZVVwZGF0ZSgpCiAgICB9LAogICAgY2xvc2UoKSB7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQogICAgfSwKICB9Cn0K"},{"version":3,"sources":["TestCaseReviewEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TestCaseReviewEdit.vue","sourceRoot":"src/pages/track/review/components","sourcesContent":["<template>\n  <div>\n    <el-dialog\n      :close-on-click-modal=\"false\"\n      :visible.sync=\"dialogFormVisible\"\n      class=\"dialog-title\"\n      title=\"编辑用例评审\"\n      width=\"65%\"\n      @close=\"close\"\n    >\n\n      <el-form ref=\"reviewForm\" :model=\"form\" :rules=\"rules\">\n\n        <el-row>\n          <el-col :offset=\"1\" :span=\"10\">\n            <el-form-item\n              :label-width=\"formLabelWidth\"\n              label=\"评审名称\"\n              placeholder=\"请输入评审名称\"\n              prop=\"name\"\n            >\n              <el-input v-model=\"form.name\"/>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"10\">\n            <el-form-item :label-width=\"formLabelWidth\" label=\"所属项目\" prop=\"projKey\">\n              <el-select\n                v-model=\"form.projKey\"\n                :disabled=\"true\"\n                filterable\n                placeholder=\"请选择所属项目\"\n                style=\"width: 100%\"\n              >\n                <el-option\n                  v-for=\"item in projects\"\n                  :key=\"item.key\"\n                  :label=\"item.name\"\n                  :value=\"item.key\"\n                >\n                </el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n        </el-row>\n\n        <el-row>\n          <el-col :offset=\"1\" :span=\"10\">\n            <el-form-item :label-width=\"formLabelWidth\" label=\"评审人\" prop=\"reviewer\">\n              <el-select\n                v-model=\"form.reviewerList\"\n                filterable\n                multiple\n                placeholder=\"请选择评审人\"\n              >\n                <el-option\n                  v-for=\"item in reviewerOptions\"\n                  :key=\"item.value\"\n                  :label=\"item.text\"\n                  :value=\"item.value\"\n                >\n                </el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"10\">\n            <el-form-item :label-width=\"formLabelWidth\" label=\"截止时间\" prop=\"targetEnd\">\n              <el-date-picker\n                v-model=\"form.targetEnd\"\n                :picker-options=\"pickerOptionsStart\"\n                placeholder=\"选择日期\"\n                type=\"datetime\"\n                value-format=\"yyyy-MM-dd HH:mm:ss\"\n              />\n            </el-form-item>\n          </el-col>\n        </el-row>\n\n\n        <el-row class=\"row-content\">\n          <el-col :offset=\"1\" :span=\"20\">\n            <el-form-item :label-width=\"formLabelWidth\" label=\"描述\" prop=\"description\">\n              <el-input\n                v-model=\"form.description\"\n                :autosize=\"{ minRows: 2, maxRows: 4}\"\n                :rows=\"2\"\n                placeholder=\"请输入内容\"\n                type=\"textarea\"\n              />\n            </el-form-item>\n          </el-col>\n        </el-row>\n\n        <el-row v-if=\"operation === operationEnum.EDIT\" class=\"row-content\">\n          <el-col :offset=\"1\" :span=\"20\">\n            <el-form-item :label-width=\"formLabelWidth\" label=\"当前状态\" prop=\"status\">\n              <test-review-status-button :status=\"form.status\" @statusChange=\"statusChange\"/>\n            </el-form-item>\n          </el-col>\n        </el-row>\n\n      </el-form>\n\n      <template slot=\"footer\">\n        <dialog-footer @cancel=\"dialogFormVisible = false\" @confirm=\"saveReview\"/>\n      </template>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {testReviewApi} from \"@/api\"\nimport {RequestUpdateTestCaseReview} from \"@/api/types/testReview\"\nimport {typeReviewData} from \"@/api/types/testReviewType\"\nimport variables from \"@/assets/css/utils.scss\"\nimport DialogFooter from \"@/common/components/DialogFooter.vue\"\nimport {datePickerOptionsStart} from \"@/common/utils\"\nimport {operationEnum} from \"@/constant/TestCase\"\nimport {reviewStatusEnum} from \"@/constant/TestReivew\"\nimport TestReviewStatusButton from \"@/pages/track/review/commom/TestReviewStatusButton.vue\"\nimport {reviewForm, reviewFormRules} from \"@/pages/track/review/forms\"\nimport {cloneDeep} from \"lodash\"\n\nexport default {\n  name: \"TestCaseReviewEdit\",\n  components: {DialogFooter, TestReviewStatusButton},\n  data() {\n    return {\n      operationEnum: operationEnum,\n      projects: this.projects,\n      dialogFormVisible: false,\n      form: reviewForm,\n      rules: reviewFormRules,\n      operation: '',\n      reviewerOptions: [],\n      pickerOptionsStart: {},\n    }\n  },\n  props: {\n    condition: Object,\n  },\n  inject: ['projects'],\n  computed: {\n    formLabelWidth() {\n      return variables['formLabelWidth']\n    },\n  },\n  mounted() {\n    this.$eventBus.$on(\"caseReviewEdit\", (caseReview: typeReviewData) => {\n      this.open(caseReview)\n    })\n  },\n  methods: {\n    initOptions() {\n      this.reviewerOptions = this.condition.reviewerOptions\n    },\n    initDateOptions() {\n      this.pickerOptionsStart = datePickerOptionsStart()\n    },\n    open(caseReview: typeReviewData) {\n      this.initOptions()\n      this.initDateOptions()\n      //修改\n      if (caseReview) {\n        this.form = cloneDeep(caseReview)\n        this.operation = operationEnum.EDIT\n      }\n      // console.log(this.form)\n      this.dialogFormVisible = true\n    },\n    saveReview() {\n      this.$refs['reviewForm'].validate((valid: boolean) => {\n        if (valid) {\n          let reviewBody: RequestUpdateTestCaseReview = {\n            name: this.form.name,\n            targetEnd: this.form.targetEnd || null,\n            reviewer: this.form.reviewerList,\n            status: this.form.status,\n          }\n          testReviewApi.updateTestCaseReview(this.form.id, reviewBody)\n            .then(() => {\n              this.$emit(\"refresh\")\n              this.close()\n            })\n        }\n      })\n    },\n    statusChange(status: reviewStatusEnum) {\n      this.form.status = status\n      this.$forceUpdate()\n    },\n    close() {\n      this.dialogFormVisible = false\n    },\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"src/assets/css/display\";\n@import \"src/assets/css/utils\";\n\n.dialog-title {\n  @extend %dialog-title\n}\n\n.row-content {\n  margin-top: 10px;\n  @extend %flex-left-center-row;\n}\n</style>\n\n"]}]}