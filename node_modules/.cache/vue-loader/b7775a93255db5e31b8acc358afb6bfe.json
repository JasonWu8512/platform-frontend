{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/testTools/approvalNotify.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/testTools/approvalNotify.vue","mtime":1667291631380},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/ts-loader/index.js","mtime":1644314987889},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7YXBwcm92YWxBcGl9IGZyb20gIkAvYXBpIgppbXBvcnQgewogIFJlcXVlc3RDcmVhdGVBcHByb3ZhbENoYXRDb25maWcsCiAgUmVxdWVzdEdldEFwcHJvdmFsQ2hhdENvbmZpZ0xpc3QsCiAgUmVxdWVzdFVwZGF0ZUFwcHJvdmFsQ2hhdENvbmZpZywKICB0eXBlQXBwcm92YWxDaGF0RGF0YQp9IGZyb20gIkAvYXBpL3R5cGVzL2FwcHJvdmFsIgppbXBvcnQgdmFyaWFibGVzIGZyb20gIkAvYXNzZXRzL2Nzcy91dGlscy5zY3NzIgppbXBvcnQgRGlhbG9nRm9vdGVyIGZyb20gJ0AvY29tbW9uL2NvbXBvbmVudHMvRGlhbG9nRm9vdGVyLnZ1ZScKaW1wb3J0IFRhYmxlUGFnaW5hdGlvbiBmcm9tICJAL2NvbW1vbi9jb21wb25lbnRzL3BhZ2luYXRpb24vVGFibGVQYWdpbmF0aW9uLnZ1ZSIKaW1wb3J0IFRhYmxlSGVhZGVyIGZyb20gIkAvY29tbW9uL2NvbXBvbmVudHMvVGFibGVIZWFkZXIudnVlIgppbXBvcnQgVGFibGVPcGVyYXRvciBmcm9tICJAL2NvbW1vbi9jb21wb25lbnRzL1RhYmxlT3BlcmF0b3IudnVlIgppbXBvcnQge19maWx0ZXJ9IGZyb20gIkAvY29tbW9uL3V0aWxzIgppbXBvcnQge1BBR0lOQVRJT05fU0laRX0gZnJvbSAiQC9jb25zdGFudCIKaW1wb3J0IHtvcGVyYXRpb25FbnVtfSBmcm9tICJAL2NvbnN0YW50L0dpdGxhYiIKaW1wb3J0IHtwbGFuU3RhZ2VFbnVtfSBmcm9tICJAL2NvbnN0YW50L1Rlc3RQbGFuIgppbXBvcnQge2FwcHJvdmFsTm90aWZ5Rm9ybSwgYXBwcm92YWxOb3RpZnlSdWxlc30gZnJvbSAiQC9wYWdlcy90ZXN0VG9vbHMvZm9ybSIKaW1wb3J0IHtjbG9uZURlZXB9IGZyb20gImxvZGFzaCIKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiYXBwcm92YWxOb3RpZnkiLAogIGNvbXBvbmVudHM6IHsKICAgIFRhYmxlT3BlcmF0b3IsCiAgICBUYWJsZUhlYWRlciwKICAgIFRhYmxlUGFnaW5hdGlvbiwKICAgIERpYWxvZ0Zvb3RlciwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjb25kaXRpb246IHt9LAogICAgICBvcGVyYXRpb25FbnVtOiBvcGVyYXRpb25FbnVtLAogICAgICBwbGFuU3RhZ2VFbnVtOiBwbGFuU3RhZ2VFbnVtLAogICAgICB0YWJsZURhdGE6IFtdLAogICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgcGFnZVNpemU6IFBBR0lOQVRJT05fU0laRS5MQVJHRSwKICAgICAgdG90YWw6IDAsCiAgICAgIGZvcm06IGFwcHJvdmFsTm90aWZ5Rm9ybSwKICAgICAgcnVsZXM6IGFwcHJvdmFsTm90aWZ5UnVsZXMsCiAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlOiBmYWxzZSwKICAgICAgbGFya0NoYXRPcHRpb25zOiBbXSwKICAgICAgb3BlcmF0aW9uOiAnJywKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBmb3JtTGFiZWxXaWR0aCgpIHsKICAgICAgcmV0dXJuIHZhcmlhYmxlc1snZm9ybUxhYmVsV2lkdGgnXQogICAgfSwKICAgIGxvYWRpbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5sb2FkaW5nCiAgICB9LAogICAgamlyYVByb2plY3RPcHRpb25zKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuamlyYS5wcm9qZWN0cwogICAgfSwKICAgIGNoYXRPcHRpb25zKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuY292ZXJhZ2UubGFya0NoYXRzCiAgICB9LAogICAgdGFibGUyQnRuV2lkdGgoKSB7CiAgICAgIHJldHVybiB2YXJpYWJsZXNbJ3RhYmxlMkJ0bldpZHRoJ10KICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmluaXRUYWJsZURhdGEoKQogIH0sCiAgbWV0aG9kczogewogICAgaW5pdE9wdGlvbnMoKSB7CiAgICAgIHRoaXMuc2V0TGFya0NoYXRPcHRpb25zKCkKICAgIH0sCiAgICBpbml0VGFibGVEYXRhKCkgewogICAgICB0aGlzLmluaXRPcHRpb25zKCkKICAgICAgdGhpcy5nZXREYXRhKCkKICAgIH0sCiAgICBidWlsZFBhcmFtcygpIHsKICAgICAgbGV0IGJvZHk6IFJlcXVlc3RDcmVhdGVBcHByb3ZhbENoYXRDb25maWcgfCBSZXF1ZXN0VXBkYXRlQXBwcm92YWxDaGF0Q29uZmlnID0gewogICAgICAgIHByb2plY3Q6IHRoaXMuZm9ybS5wcm9qZWN0LAogICAgICAgIGNoYXRJZDogdGhpcy5mb3JtLmNoYXRJZCwKICAgICAgfQogICAgICByZXR1cm4gYm9keQogICAgfSwKICAgIGdldERhdGEodmFsdWU/OiBzdHJpbmcpIHsKICAgICAgY29uc3QgcGFyYW1zOiBSZXF1ZXN0R2V0QXBwcm92YWxDaGF0Q29uZmlnTGlzdCA9IHsKICAgICAgICBvZmZzZXQ6IHRoaXMucGFnZVNpemUgKiAodGhpcy5jdXJyZW50UGFnZSAtIDEpLAogICAgICAgIGxpbWl0OiB0aGlzLnBhZ2VTaXplLAogICAgICAgIHByb2plY3Q6IHZhbHVlCiAgICAgIH0KCiAgICAgIHRoaXMuY29uZmlnRmlsdGVyID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSh0aGlzLiRyb3V0ZS5wYXRoKQogICAgICB0aGlzLmNvbmZpZ0ZpbHRlciA9IHRoaXMuY29uZmlnRmlsdGVyID8gSlNPTi5wYXJzZSh0aGlzLmNvbmZpZ0ZpbHRlcikgOiB7fQogICAgICBpZiAoSlNPTi5zdHJpbmdpZnkodGhpcy5jb25maWdGaWx0ZXIpICE9PSAie30iKSB7CiAgICAgICAgT2JqZWN0LmFzc2lnbihwYXJhbXMsIHRoaXMuY29uZmlnRmlsdGVyKQogICAgICAgIHRoaXMuJHJlZnMudGFibGUuY29sdW1ucy5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHsKICAgICAgICAgIGl0ZW0uZmlsdGVyZWRWYWx1ZSA9IHRoaXMuY29uZmlnRmlsdGVyW2l0ZW0uY29sdW1uS2V5XQogICAgICAgIH0pCiAgICAgIH0KCiAgICAgIGFwcHJvdmFsQXBpLmdldEFwcHJvdmFsQ2hhdENvbmZpZyhwYXJhbXMpCiAgICAgICAgLnRoZW4oKHtkYXRhfSkgPT4gewogICAgICAgICAgdGhpcy50b3RhbCA9IGRhdGEudG90YWwKICAgICAgICAgIHRoaXMudGFibGVEYXRhID0gZGF0YS5kYXRhCiAgICAgICAgICB0aGlzLnRhYmxlRGF0YS5mb3JFYWNoKChpdGVtOiB0eXBlQXBwcm92YWxDaGF0RGF0YSkgPT4gewogICAgICAgICAgICBpdGVtLmNoYXROYW1lID0gdGhpcy5jaGF0T3B0aW9ucy5maW5kKChzOiB7IGlkOiBudW1iZXIgfSkgPT4gU3RyaW5nKHMuaWQpID09PSBpdGVtLmNoYXRJZCkubmFtZQogICAgICAgICAgICBpdGVtLnByb2plY3QgPSB0aGlzLmppcmFQcm9qZWN0T3B0aW9ucy5maW5kKChzOiB7IGlkOiBzdHJpbmcgfSkgPT4gcy5pZCA9PT0gaXRlbS5wcm9qZWN0KS5uYW1lCiAgICAgICAgICB9KQogICAgICAgIH0pCiAgICB9LAogICAgc2F2ZUNvbmZpZygpIHsKICAgICAgdGhpcy4kcmVmcy5hcHByb3ZhbE5vdGlmeUZvcm0udmFsaWRhdGUoKHZhbGlkOiBib29sZWFuKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBpZiAodGhpcy5vcGVyYXRpb24gPT09IG9wZXJhdGlvbkVudW0uQUREKSB7CiAgICAgICAgICAgIGNvbnN0IGJvZHk6IFJlcXVlc3RDcmVhdGVBcHByb3ZhbENoYXRDb25maWcgPSB0aGlzLmJ1aWxkUGFyYW1zKCkKICAgICAgICAgICAgYXBwcm92YWxBcGkuY3JlYXRlQXBwcm92YWxDaGF0Q29uZmlnKGJvZHkpCiAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCkKICAgICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9wZXJhdGlvbiA9PT0gb3BlcmF0aW9uRW51bS5FRElUKSB7CiAgICAgICAgICAgIGNvbnN0IGJvZHk6IFJlcXVlc3RVcGRhdGVBcHByb3ZhbENoYXRDb25maWcgPSB0aGlzLmJ1aWxkUGFyYW1zKCkKICAgICAgICAgICAgYXBwcm92YWxBcGkudXBkYXRlQXBwcm92YWxDaGF0Q29uZmlnKHRoaXMuZm9ybS5pZCwgYm9keSkKICAgICAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2goKQogICAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2UKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGhhbmRsZUFkZE9yRWRpdChhcHByb3ZhbENoYXRDb25maWc/OiB0eXBlQXBwcm92YWxDaGF0RGF0YSkgewogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgaWYgKHRoaXMuJHJlZnMuYXBwcm92YWxOb3RpZnlGb3JtKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmFwcHJvdmFsTm90aWZ5Rm9ybS5yZXNldEZpZWxkcygpCiAgICAgICAgfQogICAgICAgIHRoaXMub3BlcmF0aW9uID0gb3BlcmF0aW9uRW51bS5BREQKICAgICAgICAvL+S/ruaUuQogICAgICAgIGlmIChhcHByb3ZhbENoYXRDb25maWcpIHsKICAgICAgICAgIHRoaXMub3BlcmF0aW9uID0gb3BlcmF0aW9uRW51bS5FRElUCiAgICAgICAgICB0aGlzLmZvcm0gPSBjbG9uZURlZXAoYXBwcm92YWxDaGF0Q29uZmlnKQogICAgICAgICAgdGhpcy5mb3JtLmlzQWN0aXZlID0gU3RyaW5nKHRoaXMuZm9ybS5pc0ppcmFBY3RpdmUpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZm9ybSA9IGFwcHJvdmFsTm90aWZ5Rm9ybQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVEZWxldGUoYXBwcm92YWxDaGF0Q29uZmlnOiB0eXBlQXBwcm92YWxDaGF0RGF0YSkgewogICAgICB0aGlzLiRhbGVydCgn56Gu6K6k5Yig6Zmk6K+l6YWN572uPycsICcnLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgY2FsbGJhY2s6IChhY3Rpb246IHN0cmluZykgPT4gewogICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ2NvbmZpcm0nKSB7CiAgICAgICAgICAgIGFwcHJvdmFsQXBpLmRlbGV0ZUFwcHJvdmFsQ2hhdENvbmZpZyhhcHByb3ZhbENoYXRDb25maWcuaWQpCiAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCkKICAgICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVTZWFyY2godmFsdWU/OiBzdHJpbmcpIHsKICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IDEKICAgICAgdGhpcy5nZXREYXRhKHZhbHVlKQogICAgfSwKICAgIHJlZnJlc2goKSB7CiAgICAgIHRoaXMuaW5pdFRhYmxlRGF0YSgpCiAgICB9LAogICAgZmlsdGVyKGZpbHRlcnM6IGFueSkgewogICAgICB0aGlzLmN1cnJlbnRQYWdlID0gMQogICAgICBfZmlsdGVyKGZpbHRlcnMsIHRoaXMuY29uZmlnRmlsdGVyLCB0aGlzLiRyb3V0ZS5wYXRoKQogICAgICB0aGlzLmluaXRUYWJsZURhdGEoKQogICAgfSwKICAgIHNldExhcmtDaGF0T3B0aW9ucygpIHsKICAgICAgLy8g576k6IGK562b6YCJCiAgICAgIHRoaXMubGFya0NoYXRPcHRpb25zID0gT2JqZWN0LmVudHJpZXModGhpcy5jaGF0T3B0aW9ucykubWFwKChba2V5LCB2YWx1ZV0pID0+IHsKICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgcmV0dXJuIHt0ZXh0OiB2YWx1ZS5uYW1lLCB2YWx1ZTogU3RyaW5nKHZhbHVlLmlkKSwga2V5OiBrZXl9CiAgICAgIH0pCiAgICB9CiAgfSwKfQo="},{"version":3,"sources":["approvalNotify.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"approvalNotify.vue","sourceRoot":"src/pages/testTools","sourcesContent":["<template>\n  <div>\n    <el-card class=\"card-content\">\n      <template slot=\"header\">\n        <table-header\n          :condition=\"condition\"\n          create-tip=\"审批流通知配置\"\n          placeholder=\"根据项目名称搜索\"\n          @create=\"handleAddOrEdit\"\n          @search=\"handleSearch\"\n        >\n          <template slot=\"title\">\n            <div>审批流通知配置</div>\n          </template>\n        </table-header>\n      </template>\n      <el-table ref=\"table\" v-loading=\"loading\" :data=\"tableData\" @filter-change=\"filter\">\n\n        <!--  项目名称  -->\n        <el-table-column label=\"项目名称\" prop=\"project\" show-overflow-tooltip/>\n\n        <!--  群聊  -->\n        <el-table-column :filters=\"larkChatOptions\" column-key=\"chatId\" label=\"群聊\" prop=\"chatName\"/>\n\n        <!--  操作  -->\n        <el-table-column :width=\"table2BtnWidth\" label=\"操作\">\n          <template slot-scope=\"scope\">\n            <table-operator\n              show-delete\n              show-edit\n              @deleteClick=\"handleDelete(scope.row)\"\n              @editClick=\"handleAddOrEdit(scope.row)\"\n            />\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <table-pagination\n        :change=\"initTableData\"\n        :current-page.sync=\"currentPage\"\n        :page-size.sync=\"pageSize\"\n        :total=\"total\"\n      />\n    </el-card>\n\n    <el-dialog\n      :close-on-click-modal=\"false\"\n      :title=\"operation === operationEnum.EDIT? '编辑审批流通知配置' : '创建审批流通知配置'\"\n      :visible.sync=\"dialogFormVisible\"\n      class=\"dialog-title\"\n      width=\"65%\"\n    >\n\n      <el-form ref=\"approvalNotifyForm\" :model=\"form\" :rules=\"rules\">\n        <el-row>\n          <el-col :offset=\"1\" :span=\"10\">\n            <el-form-item :label-width=\"formLabelWidth\" label=\"项目\" prop=\"project\">\n              <el-select v-model=\"form.project\" filterable placeholder=\"请选择项目\">\n                <el-option\n                  v-for=\"item in jiraProjectOptions\"\n                  :key=\"item.id\"\n                  :label=\"item.name\"\n                  :value=\"item.id\"\n                />\n              </el-select>\n            </el-form-item>\n          </el-col>\n\n          <el-col :span=\"10\">\n            <el-form-item :label-width=\"formLabelWidth\" label=\"推送群聊\" prop=\"chatId\">\n              <el-select\n                v-model=\"form.chatId\"\n                filterable\n                placeholder=\"请选择需要通知的群\"\n                style=\"width: 100%;\"\n              >\n                <el-option\n                  v-for=\"item in larkChatOptions\"\n                  :key=\"item.value\"\n                  :label=\"item.text\"\n                  :value=\"item.value\"\n                />\n              </el-select>\n            </el-form-item>\n          </el-col>\n        </el-row>\n      </el-form>\n\n      <template slot=\"footer\">\n        <dialog-footer @cancel=\"dialogFormVisible = false\" @confirm=\"saveConfig\"/>\n      </template>\n    </el-dialog>\n  </div>\n\n</template>\n\n<script lang=\"ts\">\nimport {approvalApi} from \"@/api\"\nimport {\n  RequestCreateApprovalChatConfig,\n  RequestGetApprovalChatConfigList,\n  RequestUpdateApprovalChatConfig,\n  typeApprovalChatData\n} from \"@/api/types/approval\"\nimport variables from \"@/assets/css/utils.scss\"\nimport DialogFooter from '@/common/components/DialogFooter.vue'\nimport TablePagination from \"@/common/components/pagination/TablePagination.vue\"\nimport TableHeader from \"@/common/components/TableHeader.vue\"\nimport TableOperator from \"@/common/components/TableOperator.vue\"\nimport {_filter} from \"@/common/utils\"\nimport {PAGINATION_SIZE} from \"@/constant\"\nimport {operationEnum} from \"@/constant/Gitlab\"\nimport {planStageEnum} from \"@/constant/TestPlan\"\nimport {approvalNotifyForm, approvalNotifyRules} from \"@/pages/testTools/form\"\nimport {cloneDeep} from \"lodash\"\n\nexport default {\n  name: \"approvalNotify\",\n  components: {\n    TableOperator,\n    TableHeader,\n    TablePagination,\n    DialogFooter,\n  },\n  data() {\n    return {\n      condition: {},\n      operationEnum: operationEnum,\n      planStageEnum: planStageEnum,\n      tableData: [],\n      currentPage: 1,\n      pageSize: PAGINATION_SIZE.LARGE,\n      total: 0,\n      form: approvalNotifyForm,\n      rules: approvalNotifyRules,\n      dialogFormVisible: false,\n      larkChatOptions: [],\n      operation: '',\n    }\n  },\n  computed: {\n    formLabelWidth() {\n      return variables['formLabelWidth']\n    },\n    loading() {\n      return this.$store.state.loading\n    },\n    jiraProjectOptions() {\n      return this.$store.state.jira.projects\n    },\n    chatOptions() {\n      return this.$store.state.coverage.larkChats\n    },\n    table2BtnWidth() {\n      return variables['table2BtnWidth']\n    }\n  },\n  mounted() {\n    this.initTableData()\n  },\n  methods: {\n    initOptions() {\n      this.setLarkChatOptions()\n    },\n    initTableData() {\n      this.initOptions()\n      this.getData()\n    },\n    buildParams() {\n      let body: RequestCreateApprovalChatConfig | RequestUpdateApprovalChatConfig = {\n        project: this.form.project,\n        chatId: this.form.chatId,\n      }\n      return body\n    },\n    getData(value?: string) {\n      const params: RequestGetApprovalChatConfigList = {\n        offset: this.pageSize * (this.currentPage - 1),\n        limit: this.pageSize,\n        project: value\n      }\n\n      this.configFilter = sessionStorage.getItem(this.$route.path)\n      this.configFilter = this.configFilter ? JSON.parse(this.configFilter) : {}\n      if (JSON.stringify(this.configFilter) !== \"{}\") {\n        Object.assign(params, this.configFilter)\n        this.$refs.table.columns.forEach((item: any) => {\n          item.filteredValue = this.configFilter[item.columnKey]\n        })\n      }\n\n      approvalApi.getApprovalChatConfig(params)\n        .then(({data}) => {\n          this.total = data.total\n          this.tableData = data.data\n          this.tableData.forEach((item: typeApprovalChatData) => {\n            item.chatName = this.chatOptions.find((s: { id: number }) => String(s.id) === item.chatId).name\n            item.project = this.jiraProjectOptions.find((s: { id: string }) => s.id === item.project).name\n          })\n        })\n    },\n    saveConfig() {\n      this.$refs.approvalNotifyForm.validate((valid: boolean) => {\n        if (valid) {\n          if (this.operation === operationEnum.ADD) {\n            const body: RequestCreateApprovalChatConfig = this.buildParams()\n            approvalApi.createApprovalChatConfig(body)\n              .then(() => {\n                this.refresh()\n              })\n          } else if (this.operation === operationEnum.EDIT) {\n            const body: RequestUpdateApprovalChatConfig = this.buildParams()\n            approvalApi.updateApprovalChatConfig(this.form.id, body)\n              .then(() => {\n                this.refresh()\n              })\n          }\n          this.dialogFormVisible = false\n        } else {\n          return false\n        }\n      })\n    },\n    handleAddOrEdit(approvalChatConfig?: typeApprovalChatData) {\n      this.dialogFormVisible = true\n      this.$nextTick(() => {\n        if (this.$refs.approvalNotifyForm) {\n          this.$refs.approvalNotifyForm.resetFields()\n        }\n        this.operation = operationEnum.ADD\n        //修改\n        if (approvalChatConfig) {\n          this.operation = operationEnum.EDIT\n          this.form = cloneDeep(approvalChatConfig)\n          this.form.isActive = String(this.form.isJiraActive)\n        } else {\n          this.form = approvalNotifyForm\n        }\n      })\n    },\n    handleDelete(approvalChatConfig: typeApprovalChatData) {\n      this.$alert('确认删除该配置?', '', {\n        confirmButtonText: '确定',\n        showCancelButton: true,\n        cancelButtonText: '取消',\n        callback: (action: string) => {\n          if (action === 'confirm') {\n            approvalApi.deleteApprovalChatConfig(approvalChatConfig.id)\n              .then(() => {\n                this.refresh()\n              })\n          }\n        }\n      })\n    },\n    handleSearch(value?: string) {\n      this.currentPage = 1\n      this.getData(value)\n    },\n    refresh() {\n      this.initTableData()\n    },\n    filter(filters: any) {\n      this.currentPage = 1\n      _filter(filters, this.configFilter, this.$route.path)\n      this.initTableData()\n    },\n    setLarkChatOptions() {\n      // 群聊筛选\n      this.larkChatOptions = Object.entries(this.chatOptions).map(([key, value]) => {\n        // @ts-ignore\n        return {text: value.name, value: String(value.id), key: key}\n      })\n    }\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"src/assets/css/utils\";\n\n.card-content {\n  overflow-y: auto;\n}\n\n.dialog-title {\n  @extend %dialog-title;\n}\n</style>\n"]}]}