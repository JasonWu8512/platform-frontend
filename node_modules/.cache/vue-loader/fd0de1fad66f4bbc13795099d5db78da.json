{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/common/components/search/TableAdvSearchBar.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/common/components/search/TableAdvSearchBar.vue","mtime":1655949681765},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/ts-loader/index.js","mtime":1644314987889},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IGNvbXBvbmVudHMgZnJvbSAiQC9jb21tb24vY29tcG9uZW50cy9zZWFyY2gvc2VhcmNoLWNvbXBvbmVudHMiCmltcG9ydCB7Y2xvbmVEZWVwfSBmcm9tICJsb2Rhc2giCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlRhYmxlQWR2U2VhcmNoQmFyIiwKICBjb21wb25lbnRzOiB7Li4uY29tcG9uZW50c30sCiAgcHJvcHM6IHsKICAgIGNvbmRpdGlvbjogT2JqZWN0LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICBjb25maWc6IHRoaXMuaW5pdCgpCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0KCkgewogICAgICBsZXQgY29uZmlnID0gY2xvbmVEZWVwKHRoaXMuY29uZGl0aW9uKTsKICAgICAgY29uZmlnLmNvbXBvbmVudHMuZm9yRWFjaCgoY29tcG9uZW50OiBhbnkpID0+IHsKICAgICAgICBsZXQgb3BlcmF0b3IgPSBjb21wb25lbnQub3BlcmF0b3IudmFsdWU7CiAgICAgICAgY29tcG9uZW50Lm9wZXJhdG9yLnZhbHVlID0gb3BlcmF0b3IgPT09IHVuZGVmaW5lZCA/IGNvbXBvbmVudC5vcGVyYXRvci5vcHRpb25zWzBdLnZhbHVlIDogb3BlcmF0b3I7CiAgICAgIH0pCiAgICAgIHJldHVybiBjb25maWc7CiAgICB9LAogICAgc2VhcmNoKCkgewogICAgICBsZXQgY29uZGl0aW9uOiBhbnkgPSB7fQogICAgICB0aGlzLmNvbmZpZy5jb21wb25lbnRzLmZvckVhY2goKGNvbXBvbmVudDogYW55KSA9PiB7CiAgICAgICAgbGV0IG9wZXJhdG9yID0gY29tcG9uZW50Lm9wZXJhdG9yLnZhbHVlOwogICAgICAgIGxldCB2YWx1ZSA9IGNvbXBvbmVudC52YWx1ZTsKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGNvbmRpdGlvbltjb21wb25lbnQua2V5XSA9IHsKICAgICAgICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3IsCiAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09ICIiKSB7CiAgICAgICAgICAgIGNvbmRpdGlvbltjb21wb25lbnQua2V5XSA9IHsKICAgICAgICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3IsCiAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy8g5riF6ZmkbmFtZQogICAgICBpZiAodGhpcy5jb25kaXRpb24ubmFtZSkgdGhpcy5jb25kaXRpb24ubmFtZSA9IHVuZGVmaW5lZDsKICAgICAgLy8g5re75Yqg57uE5ZCI5p2h5Lu2CiAgICAgIHRoaXMuY29uZGl0aW9uLmNvbWJpbmUgPSBjb25kaXRpb247CiAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTpjb25kaXRpb24nLCB0aGlzLmNvbmRpdGlvbik7CiAgICAgIHRoaXMuJGVtaXQoJ3NlYXJjaCcsIGNvbmRpdGlvbik7CiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOwogICAgfSwKICAgIHJlc2V0KCkgewogICAgICBsZXQgc291cmNlID0gdGhpcy5jb25kaXRpb24uY29tcG9uZW50czsKICAgICAgdGhpcy5jb25maWcuY29tcG9uZW50cy5mb3JFYWNoKChjb21wb25lbnQ6IGFueSwgaW5kZXg6IGFueSkgPT4gewogICAgICAgIGlmIChjb21wb25lbnQub3BlcmF0b3IudmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgbGV0IG9wZXJhdG9yID0gc291cmNlW2luZGV4XS5vcGVyYXRvci52YWx1ZTsKICAgICAgICAgIGNvbXBvbmVudC5vcGVyYXRvci52YWx1ZSA9IG9wZXJhdG9yID09PSB1bmRlZmluZWQgPyBjb21wb25lbnQub3BlcmF0b3Iub3B0aW9uc1swXS52YWx1ZSA6IG9wZXJhdG9yOwogICAgICAgIH0KICAgICAgICBpZiAoY29tcG9uZW50LnZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGNvbXBvbmVudC52YWx1ZSA9IHNvdXJjZVtpbmRleF0udmFsdWU7CiAgICAgICAgfQogICAgICB9KQogICAgICB0aGlzLmNvbmRpdGlvbi5jb21iaW5lID0gdW5kZWZpbmVkOwogICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6Y29uZGl0aW9uJywgdGhpcy5jb25kaXRpb24pOwogICAgICB0aGlzLiRlbWl0KCdzZWFyY2gnKTsKICAgIH0sCiAgICBvcGVuKCkgewogICAgICB0aGlzLnZpc2libGUgPSB0cnVlOwogICAgfQogIH0KfQo="},{"version":3,"sources":["TableAdvSearchBar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TableAdvSearchBar.vue","sourceRoot":"src/common/components/search","sourcesContent":["<template>\n  <span class=\"adv-search-bar\">\n    <el-button type=\"text\" @click=\"open\">高级搜索</el-button>\n    <el-dialog\n      :append-to-body=\"true\"\n      :visible=\"visible\"\n      custom-class=\"adv-dialog\"\n      title=\"组合查询\"\n      @close=\"visible = false\"\n    >\n      <div class=\"search-items\">\n        <component\n          :is=\"component.name\"\n          v-for=\"(component, index) in config.components\"\n          :key=\"index\"\n          :component=\"component\"\n          class=\"search-item\"\n        />\n        </div>\n      <template slot=\"footer\">\n        <div class=\"dialog-footer\">\n          <el-button @click=\"reset\">重置</el-button>\n          <el-button type=\"primary\" @click=\"search\">查询</el-button>\n        </div>\n      </template>\n    </el-dialog>\n  </span>\n</template>\n\n<script lang=\"ts\">\nimport components from \"@/common/components/search/search-components\"\nimport {cloneDeep} from \"lodash\"\n\nexport default {\n  name: \"TableAdvSearchBar\",\n  components: {...components},\n  props: {\n    condition: Object,\n  },\n  data() {\n    return {\n      visible: false,\n      config: this.init()\n    }\n  },\n  methods: {\n    init() {\n      let config = cloneDeep(this.condition);\n      config.components.forEach((component: any) => {\n        let operator = component.operator.value;\n        component.operator.value = operator === undefined ? component.operator.options[0].value : operator;\n      })\n      return config;\n    },\n    search() {\n      let condition: any = {}\n      this.config.components.forEach((component: any) => {\n        let operator = component.operator.value;\n        let value = component.value;\n        if (Array.isArray(value)) {\n          if (value.length > 0) {\n            condition[component.key] = {\n              operator: operator,\n              value: value\n            }\n          }\n        } else {\n          if (value !== undefined && value !== null && value !== \"\") {\n            condition[component.key] = {\n              operator: operator,\n              value: value\n            }\n          }\n        }\n      });\n\n      // 清除name\n      if (this.condition.name) this.condition.name = undefined;\n      // 添加组合条件\n      this.condition.combine = condition;\n      this.$emit('update:condition', this.condition);\n      this.$emit('search', condition);\n      this.visible = false;\n    },\n    reset() {\n      let source = this.condition.components;\n      this.config.components.forEach((component: any, index: any) => {\n        if (component.operator.value !== undefined) {\n          let operator = source[index].operator.value;\n          component.operator.value = operator === undefined ? component.operator.options[0].value : operator;\n        }\n        if (component.value !== undefined) {\n          component.value = source[index].value;\n        }\n      })\n      this.condition.combine = undefined;\n      this.$emit('update:condition', this.condition);\n      this.$emit('search');\n    },\n    open() {\n      this.visible = true;\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.adv-search-bar {\n  margin-left: 5px;\n}\n\n.dialog-footer {\n  text-align: center;\n}\n\n.search-items {\n  width: 100%;\n}\n\n@media only screen and (max-width: 1469px) {\n  .search-item {\n    width: 100%;\n  }\n}\n\n@media only screen and (min-width: 1470px) {\n  .search-item {\n    width: 50%;\n  }\n}\n\n.search-item {\n  display: inline-block;\n  margin-top: 10px;\n}\n</style>\n"]}]}