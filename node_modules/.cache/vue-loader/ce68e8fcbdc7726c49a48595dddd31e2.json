{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/autoEventTrack/components/AutoEventTrackConfigEdit.vue?vue&type=style&index=0&lang=scss&coped=true&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/autoEventTrack/components/AutoEventTrackConfigEdit.vue","mtime":1659084645378},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/css-loader/dist/cjs.js","mtime":1644298105513},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1644314988580},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/@vue/cli-service/node_modules/postcss-loader/src/index.js","mtime":1644298105780},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/sass-loader/dist/cjs.js","mtime":1644314983366},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5ldmVudFRyYWNrRm9ybUl0ZW0gewogIHdpZHRoOiA2MCU7Cn0K"},{"version":3,"sources":["AutoEventTrackConfigEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6MA;AACA;AACA","file":"AutoEventTrackConfigEdit.vue","sourceRoot":"src/pages/autoEventTrack/components","sourcesContent":["<template>\n  <el-dialog\n    :close-on-click-modal=\"false\"\n    :title=\"operation === operationEnum.EDIT? '编辑自动化配置' : '创建自动化配置'\"\n    :visible.sync=\"dialogFormVisible\"\n    class=\"dialog-title\"\n    width=\"65%\"\n  >\n    <el-form ref=\"autoEventTrackConfigForm\" :model=\"form\" :rules=\"rules\">\n      <el-row>\n        <el-col :offset=\"1\" :span=\"7\">\n          <el-form-item :label-width=\"formLabelWidth\" label=\"名称\" prop=\"name\">\n            <el-input v-model=\"form.name\" placeholder=\"请输入自动化名称\"/>\n          </el-form-item>\n        </el-col>\n      </el-row>\n      <el-row>\n        <el-col :offset=\"1\" :span=\"10\">\n          <el-form-item :label-width=\"formLabelWidth\" label=\"环境:\" prop=\"env\">\n            <el-select v-model=\"form.env\" class=eventTrackFormItem placeholder=\"请选择环境\"/>\n              <el-option\n                v-for=\"item in envs\"\n                :key=item\n                :label=\"item\"\n                :value=\"item\"\n              />\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"10\">\n          <!-- <el-form-item :label-width=\"formLabelWidth\" label=\"执行方式\" prop=\"method\">\n            <el-select v-model=\"form.method\" placeholder=\"请选择执行方式\">\n              <el-option label=\"事件验证\" value=\"事件验证\"></el-option>\n              <el-option label=\"事件属性验证\" value=\"事件属性验证\"></el-option>\n            </el-select>\n          </el-form-item> -->\n          <el-form-item :label-width=\"formLabelWidth\" label=\"执行方式:\" prop=\"method\">\n            <el-select v-model=\"form.method\" placeholder=\"请选择执行方式\"/>\n              <el-option\n                v-for=\"item in methods\"\n                :key=item\n                :label=\"item\"\n                :value=\"item\"\n              />\n          </el-form-item>\n        </el-col>\n      </el-row>\n      <el-row>\n        <el-col :offset=\"1\" :span=\"10\">\n          <el-form-item :label-width=\"formLabelWidth\" label=\"定时器:\" prop=\"crontabSchedule\">\n            <el-input v-model=\"form.crontabSchedule\" placeholder=\"请输入crontab表达式：分 小时 日 月 星期\"></el-input>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"10\">\n          <el-form-item :label-width=\"formLabelWidth\" label=\"开启定时:\" prop=\"enableAutoTrigger\">\n            <el-radio v-model=\"form.enableAutoTrigger\" :label=\"true\">是</el-radio>\n            <el-radio v-model=\"form.enableAutoTrigger\" :label=\"false\">否</el-radio>\n          </el-form-item>\n        </el-col>\n      </el-row>\n      <el-row>\n        <el-col :offset=\"1\" :span=\"20\">\n          <el-form-item :label-width=\"formLabelWidth\" label=\"通知群:\" prop=\"notifyChatIds\">\n            <el-select v-model=\"form.notifyChatIds\"\n                       filterable\n                       multiple\n                       placeholder=\"请选择需要通知的群\"\n                       style=\"width: 100%;\"\n            >\n              <el-option\n                v-for=\"item in chatOptions\"\n                :key=\"item.chatId\"\n                :label=\"item.name\"\n                :value=\"item.chatId\"\n              />\n            </el-select>\n          </el-form-item>\n        </el-col>\n      </el-row>\n    </el-form>\n    <template slot=\"footer\">\n      <dialog-footer @cancel=\"dialogFormVisible = false\" @confirm=\"savePipeline\"/>\n    </template>\n  </el-dialog>\n</template>\n\n<script>\nimport {autoEventTrackApi} from \"@/api\"\nimport variables from \"@/assets/css/utils.scss\"\nimport DialogFooter from '@/common/components/DialogFooter.vue'\nimport {operationEnum} from \"@/constant/TestCase\"\nimport tagsSelect from '@/pages/autoEventTrack/components/tagsSelect.vue'\n\nexport default {\n  name: \"AutoEventTrackConfigEdit\",\n  // eslint-disable-next-line vue/no-unused-components\n  components: {DialogFooter,tagsSelect},\n  computed: {\n    owner() {\n      return this.$store.getters.userName;\n    },\n    formLabelWidth() {\n      return variables['formLabelWidth']\n    },\n    chatOptions() {\n      return this.$store.state.coverage.larkChats\n    }\n  },\n  data() { \n    // const validateTags = (rule, value, callback) => {\n    //   if (value === '' && this.form.cases.length === 0) {\n    //     callback(new Error('标签和用例必须填一项'));\n    //   } else if (value !== '' && this.form.cases.length > 0) {\n    //     callback(new Error('标签和用例只能填一项'));\n    //   } else {\n    //     callback();\n    //   }\n    // };\n    // const validateCases = (rule, value, callback) => {\n    //   console.log('value', value)\n    //   if (value.length === 0 && this.form.tags === '') {\n    //     callback(new Error('标签和用例必须填一项'));\n    //   }else if (value.length > 0 && this.form.tags !== '') {\n    //     callback(new Error('标签和用例只能填一项'));\n    //   } else {\n    //     callback();\n    //   }\n    // };\n    return { \n      dialogFormVisible: false,\n      operationEnum: operationEnum,\n      envs: ['fat', 'prod'],\n      operation: '', \n      methodOptions: [],\n      methods: ['事件验证', '事件属性验证'],\n      form: {   \n        name: '', \n        crontabSchedule: '',\n        enableAutoTrigger: false,\n        notifyChatIds: [],\n        env: 'fat',\n        method: '',\n      },\n      rules: {\n        name: [{required: true, message: '请输入自动化配置名称', trigger: 'blur'}],\n        method: [{required: true, message: '请选择执行方式', trigger: 'blur'}],\n      }\n    }\n  },\n  mounted() {},\n  methods: {\n    // 打开创建/编辑配置表单\n    open(autoEventTrackConfig) {\n      this.dialogFormVisible = true\n      this.$nextTick(() => {\n        if (this.$refs.autoEventTrackConfigForm) {\n          this.$refs['autoEventTrackConfigForm'].resetFields()\n          }\n        this.operation = operationEnum.ADD\n        //修改\n        if (autoEventTrackConfig) {\n          this.operation = operationEnum.EDIT\n          this.form.id = autoEventTrackConfig.id\n          this.form.name = autoEventTrackConfig.name\n          this.form.method = autoEventTrackConfig.method\n          this.form.crontabSchedule = autoEventTrackConfig.crontabSchedule\n          this.form.enableAutoTrigger = autoEventTrackConfig.enableAutoTrigger\n          this.form.notifyChatIds = autoEventTrackConfig.notifyChatIds\n          this.form.env = autoEventTrackConfig.env\n        }\n      })\n    },\n    // 保存自动化配置\n    savePipeline() {\n      this.$refs['autoEventTrackConfigForm'].validate((valid) => {\n        if (valid) {\n          const params = {\n            name: this.form.name,\n            method: this.form.method,\n            crontabSchedule: this.form.crontabSchedule,\n            enableAutoTrigger: this.form.enableAutoTrigger,\n            env: this.form.env,\n            notifyChatIds: this.form.notifyChatIds\n          }\n          if (this.operation === operationEnum.ADD) {\n            // @ts-ignore\n            params.owner = this.owner\n          } else if (this.operation === operationEnum.EDIT) {\n            params.id = this.form.id\n          }\n          autoEventTrackApi.createOrEditAutoEventTrackConfig(params).then(\n            () => {\n              this.$emit('fatherEventTrackMethod')\n            }\n          ).catch(() => {})\n          this.dialogFormVisible = false\n        } else {\n          return false\n        }\n      })\n    },\n  }\n}\n</script>\n\n<style lang=\"scss\" coped>\n.eventTrackFormItem {\n  width: 60%;\n}\n</style>\n"]}]}