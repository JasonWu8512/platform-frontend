{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/Team/Organization.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/Team/Organization.vue","mtime":1655949681769},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/css-loader/dist/cjs.js","mtime":1644298105513},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1644314988580},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/@vue/cli-service/node_modules/postcss-loader/src/index.js","mtime":1644298105780},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/sass-loader/dist/cjs.js","mtime":1644314983366},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmVsLXNlbGVjdC1kcm9wZG93bl9faXRlbS5ob3ZlciwgLmVsLXNlbGVjdC1kcm9wZG93bl9faXRlbTpob3ZlciB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50Owp9Ci5lbC10cmVlX19lbXB0eS10ZXh0IHsKICB0b3A6IDMwJSAhaW1wb3J0YW50OwogIGZvbnQtc2l6ZTogMTJweCAhaW1wb3J0YW50Owp9Ci5lbC10cmVlLW5vZGVfX2xhYmVsIHsKICBmb250LXNpemU6IDEycHggIWltcG9ydGFudDsKfQouZWwtY2hlY2tib3hfX2xhYmVsIHsKICBmb250LXNpemU6IDEycHggIWltcG9ydGFudDsKfQouZWwtY2hlY2tib3gtYnV0dG9uX19pbm5lciB7CiAgYm9yZGVyLXJhZGl1czogNHB4ICFpbXBvcnRhbnQ7CiAgYm9yZGVyOiAwICFpbXBvcnRhbnQ7Cn0K"},{"version":3,"sources":["Organization.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Organization.vue","sourceRoot":"src/pages/Team","sourcesContent":["<template>\n  <el-card>\n    <el-row>\n      <el-col :span=\"4\">\n        <el-select v-model=\"departmentName\" style=\"width: 100%;padding-right: 15px\">\n          <el-option :value=\"departmentId\" style=\"height: auto\">\n            <el-tree :data=\"organizations\"\n                     :props=\"defaultProps\"\n                     node-key=\"id\"\n                     ref=\"tree\"\n                     highlight-current\n                     @node-click=\"handleNodeClick\">\n            </el-tree>\n\n          </el-option>\n        </el-select>\n      </el-col>\n      <el-col :span=\"4\">\n        <el-select v-model=\"selectedAccounts\"\n                   filterable\n                   multiple\n                   collapse-tags\n                   placeholder=\"请选择成员\" @change=\"changeSelect\"\n                   style=\"width: 100%;padding-right: 15px\">\n          <el-checkbox-button v-model=\"checked\" @change='selectAll' style=\"padding-left: 5px;\">全选</el-checkbox-button>\n          <el-option v-for=\"account in accountOptions\" :key=\"account.id\" :label=\"account.name\" :value=\"account.id\"></el-option>\n        </el-select>\n      </el-col>\n      <el-col :span=\"8\">\n        <el-date-picker\n          v-model=\"start_end_date\"\n          type=\"daterange\"\n          unlink-panels\n          range-separator=\"至\"\n          start-placeholder=\"开始日期\"\n          end-placeholder=\"结束日期\"\n          value-format=\"yyyy-MM-dd\"\n          :picker-options=\"pickerOptions\"\n          style=\"width: 100%;padding-right: 15px\">\n        </el-date-picker>\n      </el-col>\n      <el-col :span=\"2\">\n        <el-button @click=\"getAccountTasksGantt\" type=\"primary\" round>查询</el-button>\n      </el-col>\n    </el-row>\n<!--    <el-card :v-loading=\"loading\">-->\n      <gantt style=\"margin-top: 30px; border-top: 1px solid #E6E6E6\" :items=\"config\" :v-loading=\"loading\"></gantt>\n<!--    </el-card>-->\n\n  </el-card>\n</template>\n\n<script>\nimport organizationApi from '@/api/organization'\nimport gantt from \"@/pages/Team/components/gantt\"\nimport Qs from \"qs\"\nexport default {\nname: \"organization\",\n  components: {gantt},\n  data() {\n  return {\n    loading: false,\n    checked: false,\n    config: {\n      tasks: {},\n      rows: {'1': {\n          assignee: '',\n        }},\n      time: {from: 0, to: 0}\n    },\n\n    start_end_date: [],\n    departmentId: '',\n    departmentName: '',\n    defaultProps: {\n      children: 'children',\n      label: 'name',\n      value: 'id'\n    },\n    organizations: [],\n    accountOptions: [],\n    selectedAccounts: [],\n    pickerOptions: {\n      shortcuts: [{\n        text: '最近一周',\n        onClick(picker) {\n          const end = new Date();\n          const start = new Date();\n          end.setTime(end.getTime() + 3600 * 1000 * 24 * 7);\n          picker.$emit('pick', [start, end]);\n        }\n      }, {\n        text: '最近一个月',\n        onClick(picker) {\n          const end = new Date();\n          const start = new Date();\n          end.setTime(end.getTime() + 3600 * 1000 * 24 * 30);\n          picker.$emit('pick', [start, end]);\n        }\n      }, {\n        text: '最近三个月',\n        onClick(picker) {\n          const end = new Date();\n          const start = new Date();\n          end.setTime(end.getTime() + 3600 * 1000 * 24 * 90);\n          picker.$emit('pick', [start, end]);\n        }\n      }]\n    },\n  }\n  },\n  mounted() {\n    this.getOrganization();\n    var end = new Date();\n    var start = new Date();\n    end.setTime(end.getTime() + 3600 * 1000 * 24 * 30)\n    this.start_end_date = [start.format('yyyy-MM-dd'), end.format('yyyy-MM-dd')]\n  },\n  methods: {\n    getOrganization(){\n      organizationApi.getAceDepartment({}).then(res => {\n        this.organizations = res.data\n        this.departmentId = this.organizations[0].id\n        this.departmentName = this.organizations[0].name\n        this.getAccountByDepartment()\n      })\n    },\n    getAccountByDepartment() {\n      organizationApi.getAccountByDepartment({openDepartmentId: this.departmentId}).then(res => {\n        this.accountOptions = res.data\n      })\n    },\n    getAccountTasksGantt() {\n      this.loading = true\n      this.config = {\n        tasks: {},\n        rows: {'1': {\n            assignee: '',\n          }},\n        time: {from: 0, to: 0}\n      }\n      organizationApi.getAccountTaskGantt({start_date:this.start_end_date[0], end_date: this.start_end_date[1]}, Qs.stringify({account_ids: this.selectedAccounts}, {arrayFormat: 'repeat'})).then(\n        res => {\n          this.config.time = res.data.time\n          res.data.items.forEach(item => {\n            this.config.tasks[item['id']] = Object.assign({}, item, {style: { // 每个块的样式\n                'border-radius': '1px',\n                'background': '#4caeca'\n              }})\n          })\n          res.data.rows.forEach((item, index) => {\n            this.config.rows[String(index + 1)] = item\n          })\n          })\n          this.loading = false\n    },\n    handleNodeClick(node){\n      this.checked = false\n      this.departmentName = node[this.defaultProps.label]\n      this.departmentId = node[this.defaultProps.value]\n      this.selectedAccounts = []\n      organizationApi.getAccountByDepartment({openDepartmentId: this.departmentId}).then(res => {\n        this.accountOptions = res.data\n        this.checked = true\n        this.selectAll()\n      })\n    },\n    selectAll(){\n      this.selectedAccounts = []\n      if (this.checked) {\n        this.accountOptions.map((item) => {\n          this.selectedAccounts.push(item.id)\n        })\n      } else {\n        this.selectedAccounts = []\n      }\n    },\n    changeSelect(val) {\n      this.checked = val.length === this.accountOptions.length;\n    },\n\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.el-select-dropdown__item.hover, .el-select-dropdown__item:hover {\n  background-color: #ffffff !important;\n}\n.el-tree__empty-text {\n  top: 30% !important;\n  font-size: 12px !important;\n}\n.el-tree-node__label {\n  font-size: 12px !important;\n}\n.el-checkbox__label {\n  font-size: 12px !important;\n}\n.el-checkbox-button__inner {\n  border-radius: 4px !important;\n  border: 0 !important;\n}\n</style>\n"]}]}