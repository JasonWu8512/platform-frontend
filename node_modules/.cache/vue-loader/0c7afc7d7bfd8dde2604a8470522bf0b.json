{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/track/common/NodeEdit.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/track/common/NodeEdit.vue","mtime":1655949681782},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/ts-loader/index.js","mtime":1644314987889},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7dGVzdENhc2VBcGl9IGZyb20gIkAvYXBpIgppbXBvcnQge1JlcXVlc3RDcmVhdGVUZXN0Q2FzZU1vZHVsZXN9IGZyb20gIkAvYXBpL3R5cGVzL3Rlc3RUcmFjayIKaW1wb3J0IHt0eXBlTm9kZX0gZnJvbSAiQC9hcGkvdHlwZXMvdGVzdFRyYWNrVHlwZSIKaW1wb3J0IERpYWxvZ0Zvb3RlciBmcm9tICJAL2NvbW1vbi9jb21wb25lbnRzL0RpYWxvZ0Zvb3Rlci52dWUiCmltcG9ydCB7b3BlcmF0aW9uRW51bX0gZnJvbSAiQC9jb25zdGFudC9UZXN0Q2FzZSIKCgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czoge0RpYWxvZ0Zvb3Rlcn0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9wZXJhdGlvbkVudW06IG9wZXJhdGlvbkVudW0sCiAgICAgIG5hbWU6ICJOb2RlRWRpdCIsCiAgICAgIGZvcm06IHsKICAgICAgICBuYW1lOiAnJywKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBuYW1lOiBbCiAgICAgICAgICB7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXlkI3np7AnLCB0cmlnZ2VyOiAnYmx1cid9LAogICAgICAgICAge21heDogMzAsIG1lc3NhZ2U6ICfplb/luqblv4XpobvlsI/kuo4zMCcsIHRyaWdnZXI6ICdibHVyJ30KICAgICAgICBdCiAgICAgIH0sCiAgICAgIHR5cGU6ICcnLAogICAgICBub2RlOiB7fSwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgfQogIH0sCiAgcHJvcHM6IHsKICAgIHRyZWVOb2RlczogQXJyYXksCiAgICBjdXJyZW50UHJvamVjdDogT2JqZWN0LAogIH0sCiAgbWV0aG9kczogewogICAgb3Blbih0eXBlOiBvcGVyYXRpb25FbnVtLCBub2RlOiB0eXBlTm9kZSkgewogICAgICB0aGlzLnR5cGUgPSB0eXBlCiAgICAgIHRoaXMubm9kZSA9IG5vZGUKICAgICAgaWYgKHR5cGUgPT09IG9wZXJhdGlvbkVudW0uRURJVCkgewogICAgICAgIHRoaXMuZm9ybS5uYW1lID0gdGhpcy5ub2RlLm5hbWUKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZvcm0ubmFtZSA9ICcnCiAgICAgIH0KICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IHRydWUKICAgIH0sCiAgICBzYXZlTm9kZSgpIHsKICAgICAgdGhpcy4kcmVmcy5ub2RlRm9ybS52YWxpZGF0ZSgodmFsaWQ6IGJvb2xlYW4pID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGlmICghdGhpcy5jdXJyZW50UHJvamVjdC5pZCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+aaguaXoOmhueebru+8jOivt+WFiOWIm+W7uumhueebricpCiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgfQogICAgICAgICAgaWYgKHRoaXMuZm9ybS5uYW1lLnRyaW0oKSA9PT0gJycpIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfor7fovpPlhaXlkI3np7AnKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuYnVpbGRQYXJhbSgpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBidWlsZFBhcmFtKCkgewogICAgICBsZXQgYm9keTogUmVxdWVzdENyZWF0ZVRlc3RDYXNlTW9kdWxlcyA9IHsKICAgICAgICBuYW1lOiB0aGlzLmZvcm0ubmFtZSwKICAgICAgICBwcm9qSWQ6IHRoaXMuY3VycmVudFByb2plY3QuaWQKICAgICAgfQogICAgICBpZiAodGhpcy50eXBlID09PSBvcGVyYXRpb25FbnVtLkFERCkgewogICAgICAgIGlmICh0aGlzLm5vZGUpIHsKICAgICAgICAgIC8v5qC56IqC54K577yM5re75Yqg6ZyA6KaB5bim5LiK54i26IqC54K5aWQKICAgICAgICAgIGJvZHkgPSBPYmplY3QuYXNzaWduKHtwYXJlbnQ6IHRoaXMubm9kZS5pZH0sIGJvZHkpCiAgICAgICAgfQogICAgICAgIHRlc3RDYXNlQXBpLmNyZWF0ZVRlc3RDYXNlTW9kdWxlcyhib2R5KQogICAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgICB0aGlzLiRlbWl0KCJyZWZyZXNoTm9kZSIpCiAgICAgICAgICAgIHRoaXMuY2xvc2UoKQogICAgICAgICAgfSkKICAgICAgfSBlbHNlIGlmICh0aGlzLnR5cGUgPT09IG9wZXJhdGlvbkVudW0uRURJVCkgewogICAgICAgIHRlc3RDYXNlQXBpLnVwZGF0ZVRlc3RDYXNlTW9kdWxlcyh0aGlzLm5vZGUuaWQsIGJvZHkpCiAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJGVtaXQoInJlZnJlc2hOb2RlIikKICAgICAgICAgICAgdGhpcy5jbG9zZSgpCiAgICAgICAgICB9KQogICAgICB9CiAgICB9LAogICAgY2xvc2UoKSB7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQogICAgfQogIH0KfQo="},{"version":3,"sources":["NodeEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"NodeEdit.vue","sourceRoot":"src/pages/track/common","sourcesContent":["<template>\n  <el-dialog\n    :before-close=\"close\"\n    :title=\"type === operationEnum.EDIT ? '重命名' : '添加模块'\"\n    :visible.sync=\"dialogFormVisible\"\n    class=\"dialog-title\"\n    width=\"30%\"\n  >\n    <el-row justify=\"center\" type=\"flex\">\n      <el-col :span=\"18\">\n        <el-form ref=\"nodeForm\" :model=\"form\" :rules=\"rules\" @submit.native.prevent>\n          <el-form-item\n            label=\"模块名称\"\n            label-width=\"80px\"\n            prop=\"name\"\n          >\n            <el-input v-model=\"form.name\"/>\n          </el-form-item>\n        </el-form>\n      </el-col>\n    </el-row>\n    <template slot=\"footer\">\n      <dialog-footer @cancel=\"close\" @confirm=\"saveNode\"/>\n    </template>\n  </el-dialog>\n</template>\n\n<script lang=\"ts\">\nimport {testCaseApi} from \"@/api\"\nimport {RequestCreateTestCaseModules} from \"@/api/types/testTrack\"\nimport {typeNode} from \"@/api/types/testTrackType\"\nimport DialogFooter from \"@/common/components/DialogFooter.vue\"\nimport {operationEnum} from \"@/constant/TestCase\"\n\n\nexport default {\n  components: {DialogFooter},\n  data() {\n    return {\n      operationEnum: operationEnum,\n      name: \"NodeEdit\",\n      form: {\n        name: '',\n      },\n      rules: {\n        name: [\n          {required: true, message: '请输入名称', trigger: 'blur'},\n          {max: 30, message: '长度必须小于30', trigger: 'blur'}\n        ]\n      },\n      type: '',\n      node: {},\n      dialogFormVisible: false,\n    }\n  },\n  props: {\n    treeNodes: Array,\n    currentProject: Object,\n  },\n  methods: {\n    open(type: operationEnum, node: typeNode) {\n      this.type = type\n      this.node = node\n      if (type === operationEnum.EDIT) {\n        this.form.name = this.node.name\n      } else {\n        this.form.name = ''\n      }\n      this.dialogFormVisible = true\n    },\n    saveNode() {\n      this.$refs.nodeForm.validate((valid: boolean) => {\n        if (valid) {\n          if (!this.currentProject.id) {\n            this.$message.warning('暂无项目，请先创建项目')\n            return\n          }\n          if (this.form.name.trim() === '') {\n            this.$message.warning('请输入名称')\n            return\n          }\n          this.buildParam()\n        } else {\n          return false\n        }\n      })\n    },\n    buildParam() {\n      let body: RequestCreateTestCaseModules = {\n        name: this.form.name,\n        projId: this.currentProject.id\n      }\n      if (this.type === operationEnum.ADD) {\n        if (this.node) {\n          //根节点，添加需要带上父节点id\n          body = Object.assign({parent: this.node.id}, body)\n        }\n        testCaseApi.createTestCaseModules(body)\n          .then(() => {\n            this.$emit(\"refreshNode\")\n            this.close()\n          })\n      } else if (this.type === operationEnum.EDIT) {\n        testCaseApi.updateTestCaseModules(this.node.id, body)\n          .then(() => {\n            this.$emit(\"refreshNode\")\n            this.close()\n          })\n      }\n    },\n    close() {\n      this.dialogFormVisible = false\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"src/assets/css/utils\";\n\n.dialog-title {\n  @extend %dialog-title;\n}\n</style>\n"]}]}