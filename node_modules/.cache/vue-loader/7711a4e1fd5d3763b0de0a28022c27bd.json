{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/track/plan/components/TestPlanList.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/track/plan/components/TestPlanList.vue","mtime":1667366879251},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/ts-loader/index.js","mtime":1644314987889},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IHt0ZXN0UGxhbkFwaX0gZnJvbSAiQC9hcGkiCmltcG9ydCB7UmVxdWVzdEdldFRlc3RDYXNlUGxhbkxpc3QsIFJlcXVlc3RVcGRhdGVBcHByb3ZhbFN0YXR1c30gZnJvbSAiQC9hcGkvdHlwZXMvdGVzdFBsYW4iCmltcG9ydCB7dHlwZVBsYW5EYXRhfSBmcm9tICJAL2FwaS90eXBlcy90ZXN0UGxhblR5cGUiCmltcG9ydCB2YXJpYWJsZXMgZnJvbSAiQC9hc3NldHMvY3NzL3V0aWxzLnNjc3MiCmltcG9ydCBUYWJsZVBhZ2luYXRpb24gZnJvbSAiQC9jb21tb24vY29tcG9uZW50cy9wYWdpbmF0aW9uL1RhYmxlUGFnaW5hdGlvbi52dWUiCmltcG9ydCBUYWJsZUhlYWRlciBmcm9tICJAL2NvbW1vbi9jb21wb25lbnRzL1RhYmxlSGVhZGVyLnZ1ZSIKaW1wb3J0IFRhYmxlT3BlcmF0b3IgZnJvbSAiQC9jb21tb24vY29tcG9uZW50cy9UYWJsZU9wZXJhdG9yLnZ1ZSIKaW1wb3J0IHtfZmlsdGVyLCBmb3JtYXRUaW1lfSBmcm9tICJAL2NvbW1vbi91dGlscyIKaW1wb3J0IHtQQUdJTkFUSU9OX1NJWkV9IGZyb20gIkAvY29uc3RhbnQiCmltcG9ydCB7UGF0aE5hbWV9IGZyb20gIkAvY29uc3RhbnQvcm91dGVEYXRhIgppbXBvcnQge3BsYW5JbnN0YW5jZVN0YXR1c0VudW0sIHBsYW5TdGFnZUVudW0sIHBsYW5TdGFnZVR5cGUsIHBsYW5TdGF0dXNFbnVtLCBwbGFuU3RhdHVzVHlwZX0gZnJvbSAiQC9jb25zdGFudC9UZXN0UGxhbiIKaW1wb3J0IFBsYW5TdGFnZVRhYmxlSXRlbSBmcm9tICJAL3BhZ2VzL3RyYWNrL2NvbW1vbi90YWJsZUl0ZW1zL1BsYW5TdGFnZVRhYmxlSXRlbS52dWUiCmltcG9ydCBQbGFuU3RhdHVzIGZyb20gIkAvcGFnZXMvdHJhY2svY29tbW9uL3RhYmxlSXRlbXMvUGxhblN0YXR1c1RhYmxlSXRlbS52dWUiCmltcG9ydCBQbGFuVGVzdFRhYmxlSXRlbSBmcm9tICJAL3BhZ2VzL3RyYWNrL2NvbW1vbi90YWJsZUl0ZW1zL1BsYW5UZXN0VGFibGVJdGVtLnZ1ZSIKaW1wb3J0IHtNZXNzYWdlfSBmcm9tICJlbGVtZW50LXVpIgoKCi8vIOW9k+WJjeeKtuaAgQpjb25zdCBwbGFuU3RhdHVzT3B0aW9ucyA9IE9iamVjdC5lbnRyaWVzKHBsYW5TdGF0dXNUeXBlKS5tYXAoKFt2YWx1ZSwgdGV4dF0pID0+IHsKICByZXR1cm4ge3RleHQ6IHRleHQsIHZhbHVlOiB2YWx1ZX0KfSkKCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlRlc3RQbGFuTGlzdCIsCiAgY29tcG9uZW50czogewogICAgUGxhblRlc3RUYWJsZUl0ZW0sCiAgICBQbGFuU3RhZ2VUYWJsZUl0ZW0sCiAgICBQbGFuU3RhdHVzLAogICAgVGFibGVPcGVyYXRvciwKICAgIFRhYmxlUGFnaW5hdGlvbiwKICAgIFRhYmxlSGVhZGVyLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBsYW5TdGF0dXNPcHRpb25zOiBwbGFuU3RhdHVzT3B0aW9ucywKICAgICAgcGxhblN0YWdlRW51bTogcGxhblN0YWdlRW51bSwKICAgICAgcGxhbkluc3RhbmNlU3RhdHVzRW51bTogcGxhbkluc3RhbmNlU3RhdHVzRW51bSwKICAgICAgcHJvamVjdHM6IHRoaXMucHJvamVjdHMsCiAgICAgIHVzZXJzOiB0aGlzLnVzZXJzLAogICAgICBpc1JlamVjdDogZmFsc2UsCiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIGN1cnJlbnRQYWdlOiAxLAogICAgICBwYWdlU2l6ZTogUEFHSU5BVElPTl9TSVpFLkxBUkdFLAogICAgICB0b3RhbDogMCwKICAgICAgY2FzZUZpbHRlcjoge30sCiAgICB9CiAgfSwKICBwcm9wczogewogICAgY29uZGl0aW9uOiBPYmplY3QsCiAgICBzdGFnZTogU3RyaW5nLAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGxvYWRpbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5sb2FkaW5nCiAgICB9LAogICAgdGFibGU0QnRuV2lkdGgoKSB7CiAgICAgIHJldHVybiB2YXJpYWJsZXNbJ3RhYmxlNEJ0bldpZHRoJ10KICAgIH0sCiAgICBwbGFuU3RhZ2VPcHRpb25zKCkgewogICAgICBpZiAodGhpcy5zdGFnZSA9PT0gcGxhblN0YWdlRW51bS5TTU9LRSkgewogICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgICByZXR1cm4gT2JqZWN0LmVudHJpZXMocGxhblN0YWdlVHlwZSkuZmlsdGVyKChbdmFsdWUsIHRleHRdKSA9PiB2YWx1ZSA9PT0gcGxhblN0YWdlRW51bS5TTU9LRSkubWFwKChbdmFsdWUsIHRleHRdKSA9PiB7CiAgICAgICAgICByZXR1cm4ge3RleHQ6IHRleHQsIHZhbHVlOiB2YWx1ZX0KICAgICAgICB9KQogICAgICB9IGVsc2UgewogICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgICByZXR1cm4gT2JqZWN0LmVudHJpZXMocGxhblN0YWdlVHlwZSkuZmlsdGVyKChbdmFsdWUsIHRleHRdKSA9PiB2YWx1ZSAhPT0gcGxhblN0YWdlRW51bS5TTU9LRSkubWFwKChbdmFsdWUsIHRleHRdKSA9PiB7CiAgICAgICAgICByZXR1cm4ge3RleHQ6IHRleHQsIHZhbHVlOiB2YWx1ZX0KICAgICAgICB9KQogICAgICB9CiAgICB9CiAgfSwKICBpbmplY3Q6IFsncHJvamVjdHMnLCAndXNlcnMnXSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pbml0VGFibGVEYXRhKCkKICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXRUYWJsZURhdGEoKSB7CiAgICAgIHRoaXMuc2V0U2VsZWN0T3B0aW9ucygpCiAgICAgIHRoaXMuZ2V0RGF0YSgpCiAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTpjb25kaXRpb24nLCB0aGlzLmNvbmRpdGlvbikKICAgIH0sCiAgICBzZXRTZWxlY3RPcHRpb25zKCkgewogICAgICB0aGlzLnNldE93bmVyT3B0aW9ucygpCiAgICAgIHRoaXMuc2V0UHJvamVjdE9wdGlvbnMoKQogICAgfSwKICAgIGdldERhdGEodmFsdWU/OiBzdHJpbmcpIHsKICAgICAgbGV0IGRlZmF1bHRTdGFnZSA9IHRoaXMucGxhblN0YWdlT3B0aW9ucy5tYXAoKGl0ZW06IGFueSkgPT4gewogICAgICAgIHJldHVybiBpdGVtLnZhbHVlCiAgICAgIH0pCiAgICAgIGNvbnN0IHBhcmFtczogUmVxdWVzdEdldFRlc3RDYXNlUGxhbkxpc3QgPSB7CiAgICAgICAgb2Zmc2V0OiB0aGlzLnBhZ2VTaXplICogKHRoaXMuY3VycmVudFBhZ2UgLSAxKSwKICAgICAgICBsaW1pdDogdGhpcy5wYWdlU2l6ZSwKICAgICAgICBzdGFnZTogZGVmYXVsdFN0YWdlLAogICAgICAgIG5hbWU6IHZhbHVlLAogICAgICAgIGlzUmVqZWN0OiB0aGlzLmlzUmVqZWN0LAogICAgICB9CiAgICAgIHRoaXMuY2FzZUZpbHRlciA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0odGhpcy4kcm91dGUucGF0aCkKICAgICAgdGhpcy5jYXNlRmlsdGVyID0gdGhpcy5jYXNlRmlsdGVyID8gSlNPTi5wYXJzZSh0aGlzLmNhc2VGaWx0ZXIpIDoge30KICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KHRoaXMuY2FzZUZpbHRlcikgIT09ICJ7fSIpIHsKICAgICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywgdGhpcy5jYXNlRmlsdGVyKQogICAgICAgIGlmICghdGhpcy5jYXNlRmlsdGVyLnN0YWdlIHx8IHRoaXMuY2FzZUZpbHRlci5zdGFnZS5sZW5ndGggPT09IDApIHsKICAgICAgICAgIE9iamVjdC5hc3NpZ24ocGFyYW1zLCB7c3RhZ2U6IGRlZmF1bHRTdGFnZX0pCiAgICAgICAgfQogICAgICAgIHRoaXMuJHJlZnMudGFibGUuY29sdW1ucy5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHsKICAgICAgICAgIGl0ZW0uZmlsdGVyZWRWYWx1ZSA9IHRoaXMuY2FzZUZpbHRlcltpdGVtLmNvbHVtbktleV0KICAgICAgICB9KQogICAgICB9CgogICAgICB0ZXN0UGxhbkFwaS5nZXRUZXN0Q2FzZVBsYW5MaXN0KHBhcmFtcykKICAgICAgICAudGhlbigoe2RhdGF9KSA9PiB7CiAgICAgICAgICB0aGlzLnRvdGFsID0gZGF0YS50b3RhbAogICAgICAgICAgdGhpcy50YWJsZURhdGEgPSBkYXRhLmRhdGEKICAgICAgICAgIHRoaXMudGFibGVEYXRhLmZvckVhY2goKGl0ZW06IHR5cGVQbGFuRGF0YSkgPT4gewogICAgICAgICAgICBpdGVtLnRhcmdldFN0YXJ0ID0gZm9ybWF0VGltZShpdGVtLnRhcmdldFN0YXJ0KQogICAgICAgICAgICBpdGVtLnRhcmdldEVuZCA9IGZvcm1hdFRpbWUoaXRlbS50YXJnZXRFbmQpCiAgICAgICAgICAgIGl0ZW0uYWN0dWFsU3RhcnQgPSBmb3JtYXRUaW1lKGl0ZW0uYWN0dWFsU3RhcnQpCiAgICAgICAgICAgIGl0ZW0uYWN0dWFsRW5kID0gZm9ybWF0VGltZShpdGVtLmFjdHVhbEVuZCkKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVBZGRPckVkaXQodGVzdFBsYW4/OiB0eXBlUGxhbkRhdGEpIHsKICAgICAgdGhpcy4kZXZlbnRCdXMuJGVtaXQoJ3Rlc3RQbGFuQ3JlYXRlT3JVcGRhdGUnLCB0ZXN0UGxhbiwgdGhpcy5wbGFuU3RhZ2VPcHRpb25zKQogICAgfSwKICAgIGhhbmRsZVNlYXJjaCh2YWx1ZT86IHN0cmluZywgZmV0Y2hSZWplY3Q/OiBib29sZWFuKSB7CiAgICAgIGlmIChmZXRjaFJlamVjdCkgewogICAgICAgIHRoaXMuaXNSZWplY3QgPSAhdGhpcy5pc1JlamVjdAogICAgICB9CiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAxCiAgICAgIHRoaXMuZ2V0RGF0YSh2YWx1ZSkKICAgIH0sCiAgICBoYW5kbGVEZWxldGUodGVzdFBsYW46IHR5cGVQbGFuRGF0YSkgewogICAgICB0aGlzLiRhbGVydCgn56Gu6K6k5Yig6Zmk5rWL6K+V6K6h5YiSPycsICcnLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgY2FsbGJhY2s6IChhY3Rpb246IHN0cmluZykgPT4gewogICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ2NvbmZpcm0nKSB7CiAgICAgICAgICAgIHRlc3RQbGFuQXBpLmRlbGV0ZVRlc3RDYXNlUGxhbih0ZXN0UGxhbi5pZCkKICAgICAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2goKQogICAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGhhbmRsZVN1Ym1pdCh0ZXN0UGxhbjogdHlwZVBsYW5EYXRhKSB7CiAgICAgIHRoaXMuJGV2ZW50QnVzLiRlbWl0KCJwYWNrYWdpbmdUZXN0U3VibWl0IiwgdGVzdFBsYW4pCiAgICB9LAogICAgaGFuZGxlVG9SZXBvcnQodGVzdFBsYW46IHR5cGVQbGFuRGF0YSkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogUGF0aE5hbWUuVGVzdFRyYWNrQ2FzZVBsYW5SZXBvcnQsCiAgICAgICAgcGFyYW1zOiB7cGxhbklkOiB0ZXN0UGxhbi5pZH0sCiAgICAgIH0pCiAgICB9LAogICAgcmVmcmVzaCgpIHsKICAgICAgdGhpcy5pbml0VGFibGVEYXRhKCkKICAgIH0sCiAgICBoYW5kbGVSb3dDbGljayhyb3c6IGFueSkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogUGF0aE5hbWUuVGVzdFRyYWNrQ2FzZVBsYW5WaWV3LAogICAgICAgIHBhcmFtczoge3BsYW5JZDogcm93LmlkfSwKICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVDaGFuZ2UodGVzdFBsYW46IHR5cGVQbGFuRGF0YSkgewogICAgICAvLyDlhpLng5/nlKjkvovlrqHmibnpgJrov4fpnIDopoHmtYvor5Xmo4Dmn6XpgJrov4fnjofovr4xMDAlCiAgICAgIGlmICh0aGlzLmNvbW1hbmQgPT09IHBsYW5JbnN0YW5jZVN0YXR1c0VudW0uQVBQUk9WRUQgJiYgdGVzdFBsYW4uY2hlY2tQZXJjZW50YWdlICE9PSAxMDApIHsKICAgICAgICBNZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6ICLlrqHmibnpgJrov4fpnIDopoHnoa7orqTmiJDlip/njofovr4xMDAlIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIGR1cmF0aW9uOiAzMDAwLAogICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlCiAgICAgICAgfSkKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICBsZXQgYm9keTogUmVxdWVzdFVwZGF0ZUFwcHJvdmFsU3RhdHVzID0gewogICAgICAgIHN0YXR1czogdGhpcy5jb21tYW5kLAogICAgICAgIHVzZXJFbWFpbDogdGhpcy4kc3RvcmUuc3RhdGUubG9naW4uZW1haWwsCiAgICAgIH0KICAgICAgdGVzdFBsYW5BcGkudXBkYXRlQXBwcm92YWxTdGF0dXModGVzdFBsYW4uaWQsIGJvZHkpCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgaWYgKHRoaXMuY29tbWFuZCA9PT0gcGxhbkluc3RhbmNlU3RhdHVzRW51bS5BUFBST1ZFRCkgewogICAgICAgICAgICB0ZXN0UGxhbkFwaS51cGRhdGVUZXN0Q2FzZVBsYW4odGVzdFBsYW4uaWQsIHtzdGF0dXM6IHBsYW5TdGF0dXNFbnVtLkRPTkV9KQogICAgICAgICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpCiAgICAgICAgICAgICAgfSkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgIH0sCiAgICBhcHByb3ZhbFN0YXR1cyhjb21tYW5kOiBwbGFuSW5zdGFuY2VTdGF0dXNFbnVtKSB7CiAgICAgIHRoaXMuY29tbWFuZCA9IGNvbW1hbmQKICAgIH0sCiAgICBmaWx0ZXIoZmlsdGVyczogYW55KSB7CiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAxCiAgICAgIF9maWx0ZXIoZmlsdGVycywgdGhpcy5jYXNlRmlsdGVyLCB0aGlzLiRyb3V0ZS5wYXRoKQogICAgICB0aGlzLmluaXRUYWJsZURhdGEoKQogICAgfSwKICAgIHNldE93bmVyT3B0aW9ucygpIHsKICAgICAgdGhpcy5jb25kaXRpb24ub3duZXJPcHRpb25zID0gdGhpcy51c2VycwogICAgfSwKICAgIHNldFByb2plY3RPcHRpb25zKCkgewogICAgICB0aGlzLmNvbmRpdGlvbi5wcm9qZWN0T3B0aW9ucyA9IHRoaXMucHJvamVjdHMKICAgIH0sCiAgfSwKfQo="},{"version":3,"sources":["TestPlanList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TestPlanList.vue","sourceRoot":"src/pages/track/plan/components","sourcesContent":["<template>\n  <div>\n    <el-card class=\"card-content\">\n      <template slot=\"header\">\n        <table-header\n          :condition=\"condition\"\n          create-tip=\"创建测试计划\"\n          :show-third=\"stage === planStageEnum.SMOKE\"\n          :third-tip=\"isReject ? '返回全部计划': '筛选驳回计划'\"\n          icon-third=\"el-icon-sugar\"\n          @create=\"handleAddOrEdit\"\n          @search=\"handleSearch\"\n          @thirdClick=\"handleSearch('', true)\"\n        >\n          <template slot=\"title\">\n            <div>{{ stage === planStageEnum.SMOKE ? '冒烟测试计划' : '功能测试计划' }}</div>\n          </template>\n        </table-header>\n      </template>\n      <el-table\n        ref=\"table\"\n        v-loading=\"loading\"\n        :data=\"tableData\"\n        @row-click=\"handleRowClick\"\n        @filter-change=\"filter\"\n      >\n\n        <!--  名称  -->\n        <el-table-column label=\"计划名称\" min-width=\"130\" prop=\"name\" show-overflow-tooltip/>\n\n        <!--  负责人  -->\n        <el-table-column\n          :filters=\"users\"\n          column-key=\"owner\"\n          label=\"负责人\"\n          prop=\"owner\"\n          show-overflow-tooltip\n        />\n\n        <!--  当前状态  -->\n        <el-table-column\n          :filters=\"planStatusOptions\"\n          column-key=\"status\"\n          label=\"计划状态\"\n          prop=\"status\"\n          show-overflow-tooltip\n        >\n          <template slot-scope=\"scope\">\n            <plan-status :value=\"scope.row.status\"/>\n          </template>\n        </el-table-column>\n\n        <!--  测试阶段  -->\n        <el-table-column\n          :filters=\"planStageOptions\"\n          column-key=\"stage\"\n          label=\"测试阶段\"\n          prop=\"stage\"\n          show-overflow-tooltip\n        >\n          <template slot-scope=\"scope\">\n            <plan-stage-table-item :value=\"scope.row.stage\"/>\n          </template>\n        </el-table-column>\n\n        <!--  测试进度  -->\n        <el-table-column label=\"执行成功率\" prop=\"percentage\" show-overflow-tooltip>\n          <template slot-scope=\"scope\">\n            <el-progress :percentage=\"scope.row.percentage\"/>\n          </template>\n        </el-table-column>\n        <!--  确认成功率      -->\n        <el-table-column v-if=\"stage === planStageEnum.SMOKE\" label=\"确认成功率\" prop=\"percentage\" show-overflow-tooltip>\n          <template slot-scope=\"scope\">\n            <el-progress :percentage=\"scope.row.checkPercentage\"/>\n          </template>\n        </el-table-column>\n\n        <!--  所属项目  -->\n        <el-table-column\n          :filters=\"projects\"\n          column-key=\"projId\"\n          label=\"所属项目\"\n          show-overflow-tooltip\n        >\n          <template slot-scope=\"scope\">\n            <div>{{ scope.row.projNames.join() }}</div>\n          </template>\n        </el-table-column>\n\n        <!--        &lt;!&ndash;  计划开始时间  &ndash;&gt;-->\n        <!--        <el-table-column label=\"计划开始\" prop=\"targetStart\" show-overflow-tooltip sortable/>-->\n\n        <!--        &lt;!&ndash;  计划结束时间  &ndash;&gt;-->\n        <!--        <el-table-column label=\"计划结束\" prop=\"targetEnd\" show-overflow-tooltip sortable/>-->\n\n        <!--        &lt;!&ndash;  实际开始时间  &ndash;&gt;-->\n        <!--        <el-table-column label=\"实际开始\" prop=\"actualStart\" show-overflow-tooltip sortable/>-->\n\n        <!--        &lt;!&ndash;  实际结束时间  &ndash;&gt;-->\n        <!--        <el-table-column label=\"实际结束\" prop=\"actualEnd\" show-overflow-tooltip sortable/>-->\n\n        <!--  开发提测  -->\n        <el-table-column\n          v-if=\"stage === planStageEnum.SMOKE\"\n          label=\"提测审批状态\"\n          prop=\"packagingTest\"\n          show-overflow-tooltip\n          sortable\n        >\n          <template slot-scope=\"scope\">\n            <plan-test-table-item\n              :value=\"scope.row.instanceStatus\"\n              @approvalStatus=\"approvalStatus\"\n              @handleChange=\"handleChange(scope.row)\"\n              :is-dot-hidden=\"scope.row.rejectCount > 0\"\n            />\n          </template>\n        </el-table-column>\n\n        <!--  操作  -->\n        <el-table-column :width=\"table4BtnWidth\" label=\"操作\">\n          <template slot-scope=\"scope\">\n            <table-operator\n              copy-tip=\"查看测试报告\"\n              show-copy\n              show-delete\n              show-edit\n              @copyClick=\"handleToReport(scope.row)\"\n              @deleteClick=\"handleDelete(scope.row)\"\n              @editClick=\"handleAddOrEdit(scope.row)\"\n            >\n              <template v-if=\"stage === planStageEnum.SMOKE\" slot=\"latest\">\n                <el-tooltip\n                  v-if=\"scope.row.stage === planStageEnum.SMOKE\"\n                  content=\"提测\"\n                  placement=\"top\"\n                >\n                  <el-button\n                    :disabled=\"scope.row.percentage <= 90\"\n                    circle\n                    icon=\"el-icon-s-promotion\"\n                    size=\"mini\"\n                    type=\"warning\"\n                    @click.native.stop=\"handleSubmit(scope.row)\"\n                  />\n                </el-tooltip>\n              </template>\n            </table-operator>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <table-pagination\n        :change=\"initTableData\"\n        :current-page.sync=\"currentPage\"\n        :page-size.sync=\"pageSize\"\n        :total=\"total\"\n      />\n    </el-card>\n  </div>\n</template>\n\n<script lang=\"ts\">\n\nimport {testPlanApi} from \"@/api\"\nimport {RequestGetTestCasePlanList, RequestUpdateApprovalStatus} from \"@/api/types/testPlan\"\nimport {typePlanData} from \"@/api/types/testPlanType\"\nimport variables from \"@/assets/css/utils.scss\"\nimport TablePagination from \"@/common/components/pagination/TablePagination.vue\"\nimport TableHeader from \"@/common/components/TableHeader.vue\"\nimport TableOperator from \"@/common/components/TableOperator.vue\"\nimport {_filter, formatTime} from \"@/common/utils\"\nimport {PAGINATION_SIZE} from \"@/constant\"\nimport {PathName} from \"@/constant/routeData\"\nimport {planInstanceStatusEnum, planStageEnum, planStageType, planStatusEnum, planStatusType} from \"@/constant/TestPlan\"\nimport PlanStageTableItem from \"@/pages/track/common/tableItems/PlanStageTableItem.vue\"\nimport PlanStatus from \"@/pages/track/common/tableItems/PlanStatusTableItem.vue\"\nimport PlanTestTableItem from \"@/pages/track/common/tableItems/PlanTestTableItem.vue\"\nimport {Message} from \"element-ui\"\n\n\n// 当前状态\nconst planStatusOptions = Object.entries(planStatusType).map(([value, text]) => {\n  return {text: text, value: value}\n})\n\n\nexport default {\n  name: \"TestPlanList\",\n  components: {\n    PlanTestTableItem,\n    PlanStageTableItem,\n    PlanStatus,\n    TableOperator,\n    TablePagination,\n    TableHeader,\n  },\n  data() {\n    return {\n      planStatusOptions: planStatusOptions,\n      planStageEnum: planStageEnum,\n      planInstanceStatusEnum: planInstanceStatusEnum,\n      projects: this.projects,\n      users: this.users,\n      isReject: false,\n      tableData: [],\n      currentPage: 1,\n      pageSize: PAGINATION_SIZE.LARGE,\n      total: 0,\n      caseFilter: {},\n    }\n  },\n  props: {\n    condition: Object,\n    stage: String,\n  },\n  computed: {\n    loading() {\n      return this.$store.state.loading\n    },\n    table4BtnWidth() {\n      return variables['table4BtnWidth']\n    },\n    planStageOptions() {\n      if (this.stage === planStageEnum.SMOKE) {\n        // @ts-ignore\n        // eslint-disable-next-line no-unused-vars\n        return Object.entries(planStageType).filter(([value, text]) => value === planStageEnum.SMOKE).map(([value, text]) => {\n          return {text: text, value: value}\n        })\n      } else {\n        // @ts-ignore\n        // eslint-disable-next-line no-unused-vars\n        return Object.entries(planStageType).filter(([value, text]) => value !== planStageEnum.SMOKE).map(([value, text]) => {\n          return {text: text, value: value}\n        })\n      }\n    }\n  },\n  inject: ['projects', 'users'],\n  mounted() {\n    this.initTableData()\n  },\n  methods: {\n    initTableData() {\n      this.setSelectOptions()\n      this.getData()\n      this.$emit('update:condition', this.condition)\n    },\n    setSelectOptions() {\n      this.setOwnerOptions()\n      this.setProjectOptions()\n    },\n    getData(value?: string) {\n      let defaultStage = this.planStageOptions.map((item: any) => {\n        return item.value\n      })\n      const params: RequestGetTestCasePlanList = {\n        offset: this.pageSize * (this.currentPage - 1),\n        limit: this.pageSize,\n        stage: defaultStage,\n        name: value,\n        isReject: this.isReject,\n      }\n      this.caseFilter = sessionStorage.getItem(this.$route.path)\n      this.caseFilter = this.caseFilter ? JSON.parse(this.caseFilter) : {}\n      if (JSON.stringify(this.caseFilter) !== \"{}\") {\n        Object.assign(params, this.caseFilter)\n        if (!this.caseFilter.stage || this.caseFilter.stage.length === 0) {\n          Object.assign(params, {stage: defaultStage})\n        }\n        this.$refs.table.columns.forEach((item: any) => {\n          item.filteredValue = this.caseFilter[item.columnKey]\n        })\n      }\n\n      testPlanApi.getTestCasePlanList(params)\n        .then(({data}) => {\n          this.total = data.total\n          this.tableData = data.data\n          this.tableData.forEach((item: typePlanData) => {\n            item.targetStart = formatTime(item.targetStart)\n            item.targetEnd = formatTime(item.targetEnd)\n            item.actualStart = formatTime(item.actualStart)\n            item.actualEnd = formatTime(item.actualEnd)\n          })\n        })\n    },\n    handleAddOrEdit(testPlan?: typePlanData) {\n      this.$eventBus.$emit('testPlanCreateOrUpdate', testPlan, this.planStageOptions)\n    },\n    handleSearch(value?: string, fetchReject?: boolean) {\n      if (fetchReject) {\n        this.isReject = !this.isReject\n      }\n      this.currentPage = 1\n      this.getData(value)\n    },\n    handleDelete(testPlan: typePlanData) {\n      this.$alert('确认删除测试计划?', '', {\n        confirmButtonText: '确定',\n        showCancelButton: true,\n        cancelButtonText: '取消',\n        callback: (action: string) => {\n          if (action === 'confirm') {\n            testPlanApi.deleteTestCasePlan(testPlan.id)\n              .then(() => {\n                this.refresh()\n              })\n          }\n        }\n      })\n    },\n    handleSubmit(testPlan: typePlanData) {\n      this.$eventBus.$emit(\"packagingTestSubmit\", testPlan)\n    },\n    handleToReport(testPlan: typePlanData) {\n      this.$router.push({\n        name: PathName.TestTrackCasePlanReport,\n        params: {planId: testPlan.id},\n      })\n    },\n    refresh() {\n      this.initTableData()\n    },\n    handleRowClick(row: any) {\n      this.$router.push({\n        name: PathName.TestTrackCasePlanView,\n        params: {planId: row.id},\n      })\n    },\n    handleChange(testPlan: typePlanData) {\n      // 冒烟用例审批通过需要测试检查通过率达100%\n      if (this.command === planInstanceStatusEnum.APPROVED && testPlan.checkPercentage !== 100) {\n        Message({\n          message: \"审批通过需要确认成功率达100%\",\n          type: \"warning\",\n          duration: 3000,\n          showClose: true\n        })\n        return\n      }\n      let body: RequestUpdateApprovalStatus = {\n        status: this.command,\n        userEmail: this.$store.state.login.email,\n      }\n      testPlanApi.updateApprovalStatus(testPlan.id, body)\n        .then(() => {\n          if (this.command === planInstanceStatusEnum.APPROVED) {\n            testPlanApi.updateTestCasePlan(testPlan.id, {status: planStatusEnum.DONE})\n              .then(() => {\n                this.refresh()\n              })\n          } else {\n            this.refresh()\n          }\n        })\n    },\n    approvalStatus(command: planInstanceStatusEnum) {\n      this.command = command\n    },\n    filter(filters: any) {\n      this.currentPage = 1\n      _filter(filters, this.caseFilter, this.$route.path)\n      this.initTableData()\n    },\n    setOwnerOptions() {\n      this.condition.ownerOptions = this.users\n    },\n    setProjectOptions() {\n      this.condition.projectOptions = this.projects\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.el-table {\n  cursor: pointer;\n}\n\n</style>\n"]}]}