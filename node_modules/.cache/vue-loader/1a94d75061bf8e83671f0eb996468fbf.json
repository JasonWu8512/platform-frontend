{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/auto/AutoConfigList.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/auto/AutoConfigList.vue","mtime":1668477878050},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/ts-loader/index.js","mtime":1644314987889},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7YXV0b0FwaX0gZnJvbSAiQC9hcGkiCmltcG9ydCBUYWJsZVBhZ2luYXRpb24gZnJvbSAiQC9jb21tb24vY29tcG9uZW50cy9wYWdpbmF0aW9uL1RhYmxlUGFnaW5hdGlvbi52dWUiCmltcG9ydCBUYWJsZUhlYWRlciBmcm9tICJAL2NvbW1vbi9jb21wb25lbnRzL1RhYmxlSGVhZGVyLnZ1ZSIKaW1wb3J0IFRhYmxlT3BlcmF0b3IgZnJvbSAiQC9jb21tb24vY29tcG9uZW50cy9UYWJsZU9wZXJhdG9yLnZ1ZSIKaW1wb3J0IHtQQUdJTkFUSU9OX1NJWkV9IGZyb20gIkAvY29uc3RhbnQiCmltcG9ydCB7UGF0aE5hbWV9IGZyb20gIkAvY29uc3RhbnQvcm91dGVEYXRhIgppbXBvcnQgQXV0b0NvbmZpZ0VkaXQgZnJvbSAiQC9wYWdlcy9hdXRvL2NvbXBvbmVudHMvQXV0b0NvbmZpZ0VkaXQudnVlIgpleHBvcnQgZGVmYXVsdCB7Cm5hbWU6ICJBdXRvQ29uZmlnTGlzdCIsCiAgY29tcG9uZW50czoge1RhYmxlSGVhZGVyLCBUYWJsZVBhZ2luYXRpb24sIFRhYmxlT3BlcmF0b3IsIEF1dG9Db25maWdFZGl0fSwKICBkYXRhKCkgewogIHJldHVybiB7CiAgICBub1BvbGxpbmc6IHRydWUsCiAgICBjcmVhdGVWaXNpYmxlOiBmYWxzZSwKICAgIGNvbmRpdGlvbjoge30sCiAgICB0b3RhbDogMCwKICAgIHBhZ2VTaXplOiBQQUdJTkFUSU9OX1NJWkUuTEFSR0UsCiAgICBjdXJyZW50UGFnZTogMSwKICAgIHRhYmxlRGF0YTogW10KICB9CiAgfSwKICBjb21wdXRlZDogewogICAgbG9hZGluZygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmxvYWRpbmcKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5wb2xsaW5nRGF0YUxpc3QoKQogIH0sCiAgZGVzdHJveWVkKCkgewogICAgY2xlYXJJbnRlcnZhbCh0aGlzLm15SW50ZXJ2YWwpCiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRBdXRvQ29uZmlnTGlzdCh2YWx1ZT86IHN0cmluZykgewogICAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgICAgbGltaXQ6IHRoaXMucGFnZVNpemUsCiAgICAgICAgb2Zmc2V0OiB0aGlzLnBhZ2VTaXplICogKHRoaXMuY3VycmVudFBhZ2UgLSAxKSwKICAgICAgICBuYW1lOiB2YWx1ZQogICAgICB9CiAgICAgIGF1dG9BcGkuZ2V0QXV0b0Nhc2VDb25maWdMaXN0KHBhcmFtcykudGhlbigKICAgICAgICByZXMgPT4gewogICAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICB0aGlzLnRvdGFsID0gcmVzLmRhdGEudG90YWwKICAgICAgICAgIHRoaXMubm9Qb2xsaW5nID0gdHJ1ZQogICAgICAgIH0KICAgICAgKQogICAgfSwKICAgIHBvbGxpbmdEYXRhTGlzdCh2YWx1ZT86IHN0cmluZykgewogICAgICB0aGlzLmdldEF1dG9Db25maWdMaXN0KHZhbHVlKQogICAgICBjbGVhckludGVydmFsKHRoaXMubXlJbnRlcnZhbCkKICAgICAgdGhpcy5teUludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHRoaXMubm9Qb2xsaW5nID0gZmFsc2UKICAgICAgICAgIHRoaXMuZ2V0QXV0b0NvbmZpZ0xpc3QodmFsdWUpCiAgICAgICAgfSwgMSkKICAgICAgfSwgMzAwMCkKICAgIH0sCiAgICBoYW5kbGVQb2xsaW5nRGF0YUxpc3QodmFsdWU/OiBzdHJpbmcpIHsKICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IDEKICAgICAgdGhpcy5wb2xsaW5nRGF0YUxpc3QodmFsdWUpCiAgICB9LAogICAgaGFuZGxlQWRkT3JFZGl0KHBpcGVsaW5lPzogYW55KSB7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyBET00g546w5Zyo5pu05paw5LqGCiAgICAgICAgdGhpcy4kcmVmcy5lZGl0Lm9wZW4ocGlwZWxpbmUpCiAgICAgIH0pCiAgICB9LAogICAgLy8g5Yig6Zmk5rWB5rC057q/CiAgICBoYW5kbGVEZWxldGUocm93PzogYW55KSB7CiAgICAgIHRoaXMuJGFsZXJ0KCfnoa7orqTliKDpmaToh6rliqjljJbphY3nva4/JywgJycsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICBjYWxsYmFjazogKGFjdGlvbjogc3RyaW5nKSA9PiB7CiAgICAgICAgICBpZiAoYWN0aW9uID09PSAnY29uZmlybScpIHsKICAgICAgICAgICAgYXV0b0FwaS5kZWxldGVBdXRvQ29uZmlnKHJvdy5pZCkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmdldEF1dG9Db25maWdMaXN0KCkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICkKICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KQogICAgfSwKICAgIGhhbmRsZVRvQnVpbGRSZWNvcmQocm93PzogYW55KSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiBQYXRoTmFtZS5BdXRvQ2FzZUJ1aWxkUmVjb3JkQnlDb25maWdJZCwKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGNvbmZpZ0lkOiByb3cuaWQKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgaGFuZGxlUnVuKHJvdz86IGFueSkgewogICAgICB0aGlzLiRhbGVydCgn56Gu5a6a5omn6KGM6K+l6Ieq5Yqo5YyW55So5L6L6ZuGPycsICcnLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgY2FsbGJhY2s6IChhY3Rpb246IHN0cmluZykgPT4gewogICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ2NvbmZpcm0nKSB7CiAgICAgICAgICAgIGF1dG9BcGkucnVuQXV0b0NvbmZpZyhyb3cuaWQpLnRoZW4oKQogICAgICAgICAgfQogICAgICB9CiAgICB9KQogICAgfQogIH0KCn0K"},{"version":3,"sources":["AutoConfigList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"AutoConfigList.vue","sourceRoot":"src/pages/auto","sourcesContent":["<template>\n  <el-card class=\"card-content\" >\n    <template slot=\"header\">\n      <table-header :condition=\"condition\"\n                    create-tip=\"创建自动化配置\"\n                    @create=\"handleAddOrEdit\"\n                    @search=\"handlePollingDataList\"\n      >\n        <template slot=\"title\">\n          <div>接口自动化配置</div>\n        </template>\n      </table-header>\n\n    </template>\n\n    <el-table :data=\"tableData\" size=\"medium\" v-loading=\"loading && noPolling\">\n      <el-table-column label=\"名称\" prop=\"name\"/>\n      <el-table-column label=\"环境\" prop=\"execEnv\"/>\n      <el-table-column label=\"流水线\" prop=\"pipelineIds\"/>\n      <el-table-column label=\"创建者\" prop=\"creator\"/>\n      <el-table-column label=\"定时表达式\" prop=\"crontabSchedule\"/>\n      <el-table-column label=\"定时执行\" prop=\"enableAutoTrigger\">\n        <template v-slot:default=\"scope\">\n          <span>{{scope.row.enableAutoTrigger? '是': '否'}}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\">\n        <template slot-scope=\"scope\">\n          <table-operator\n            copy-tip=\"执行记录\"\n            show-copy\n            show-delete\n            show-edit\n            show-run\n            :run-tip=\"scope.row.status === 'running' ? '正在执行': '执行'\"\n            @copyClick=\"handleToBuildRecord(scope.row)\"\n            @deleteClick=\"handleDelete(scope.row)\"\n            @editClick=\"handleAddOrEdit(scope.row)\"\n            @runClick=\"handleRun(scope.row)\"\n            :runDisable=\"scope.row.status === 'running'\"\n          >\n          </table-operator>\n        </template>\n      </el-table-column>\n\n    </el-table>\n    <table-pagination\n      :change=\"getAutoConfigList\"\n      :current-page.sync=\"currentPage\"\n      :page-size.sync=\"pageSize\"\n      :total=\"total\"\n    />\n    <auto-config-edit ref=\"edit\" @fatherMethod=\"getAutoConfigList\"></auto-config-edit>\n\n  </el-card>\n</template>\n\n<script lang=\"ts\">\nimport {autoApi} from \"@/api\"\nimport TablePagination from \"@/common/components/pagination/TablePagination.vue\"\nimport TableHeader from \"@/common/components/TableHeader.vue\"\nimport TableOperator from \"@/common/components/TableOperator.vue\"\nimport {PAGINATION_SIZE} from \"@/constant\"\nimport {PathName} from \"@/constant/routeData\"\nimport AutoConfigEdit from \"@/pages/auto/components/AutoConfigEdit.vue\"\nexport default {\nname: \"AutoConfigList\",\n  components: {TableHeader, TablePagination, TableOperator, AutoConfigEdit},\n  data() {\n  return {\n    noPolling: true,\n    createVisible: false,\n    condition: {},\n    total: 0,\n    pageSize: PAGINATION_SIZE.LARGE,\n    currentPage: 1,\n    tableData: []\n  }\n  },\n  computed: {\n    loading() {\n      return this.$store.state.loading\n    },\n  },\n  mounted() {\n    this.pollingDataList()\n  },\n  destroyed() {\n    clearInterval(this.myInterval)\n  },\n  methods: {\n    getAutoConfigList(value?: string) {\n      const params = {\n        limit: this.pageSize,\n        offset: this.pageSize * (this.currentPage - 1),\n        name: value\n      }\n      autoApi.getAutoCaseConfigList(params).then(\n        res => {\n          this.tableData = res.data.data\n          this.total = res.data.total\n          this.noPolling = true\n        }\n      )\n    },\n    pollingDataList(value?: string) {\n      this.getAutoConfigList(value)\n      clearInterval(this.myInterval)\n      this.myInterval = window.setInterval(() => {\n        setTimeout(() => {\n          this.noPolling = false\n          this.getAutoConfigList(value)\n        }, 1)\n      }, 3000)\n    },\n    handlePollingDataList(value?: string) {\n      this.currentPage = 1\n      this.pollingDataList(value)\n    },\n    handleAddOrEdit(pipeline?: any) {\n      this.$nextTick(function () {\n        // DOM 现在更新了\n        this.$refs.edit.open(pipeline)\n      })\n    },\n    // 删除流水线\n    handleDelete(row?: any) {\n      this.$alert('确认删除自动化配置?', '', {\n        confirmButtonText: '确定',\n        showCancelButton: true,\n        cancelButtonText: '取消',\n        callback: (action: string) => {\n          if (action === 'confirm') {\n            autoApi.deleteAutoConfig(row.id).then(() => {\n                this.getAutoConfigList()\n              }\n            )\n          }\n          }\n        })\n    },\n    handleToBuildRecord(row?: any) {\n      this.$router.push({\n        name: PathName.AutoCaseBuildRecordByConfigId,\n        params: {\n          configId: row.id\n        }\n      })\n    },\n    handleRun(row?: any) {\n      this.$alert('确定执行该自动化用例集?', '', {\n        confirmButtonText: '确定',\n        showCancelButton: true,\n        cancelButtonText: '取消',\n        callback: (action: string) => {\n          if (action === 'confirm') {\n            autoApi.runAutoConfig(row.id).then()\n          }\n      }\n    })\n    }\n  }\n\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}