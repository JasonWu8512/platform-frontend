{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/testTools/apolloIntlNotify.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/testTools/apolloIntlNotify.vue","mtime":1655949681778},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB2YXJpYWJsZXMgZnJvbSAiQC9hc3NldHMvY3NzL3V0aWxzLnNjc3MiCmltcG9ydCB7ZGF0YVRvb2xBcGl9IGZyb20gIkAvYXBpIjsKaW1wb3J0IHtjbG9uZURlZXB9IGZyb20gImxvZGFzaCIKaW1wb3J0IFRhYmxlT3BlcmF0b3IgZnJvbSAiQC9jb21tb24vY29tcG9uZW50cy9UYWJsZU9wZXJhdG9yIjsKaW1wb3J0IFRhYmxlSGVhZGVyIGZyb20gIkAvY29tbW9uL2NvbXBvbmVudHMvVGFibGVIZWFkZXIiOwppbXBvcnQgVGFibGVQYWdpbmF0aW9uIGZyb20gIkAvY29tbW9uL2NvbXBvbmVudHMvcGFnaW5hdGlvbi9UYWJsZVBhZ2luYXRpb24iOwppbXBvcnQgRGlhbG9nRm9vdGVyIGZyb20gIkAvY29tbW9uL2NvbXBvbmVudHMvRGlhbG9nRm9vdGVyIjsKaW1wb3J0IHtvcGVyYXRpb25FbnVtfSBmcm9tICJAL2NvbnN0YW50L0dpdGxhYiI7CmltcG9ydCB7UEFHSU5BVElPTl9TSVpFfSBmcm9tICJAL2NvbnN0YW50IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJhcG9sbG9JbnRsTm90aWZ5IiwKICBjb21wb25lbnRzOiB7CiAgICBUYWJsZU9wZXJhdG9yLAogICAgVGFibGVIZWFkZXIsCiAgICBUYWJsZVBhZ2luYXRpb24sCiAgICBEaWFsb2dGb290ZXIsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgb3BlcmF0aW9uRW51bTogb3BlcmF0aW9uRW51bSwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICBjb25kaXRpb246IHt9LAogICAgICBvcGVyYXRpb246ICcnLAogICAgICB0YWJsZURhdGE6IFtdLAogICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgcGFnZVNpemU6IFBBR0lOQVRJT05fU0laRS5MQVJHRSwKICAgICAgdG90YWw6IDAsCiAgICAgIGFwcE9wdGlvbnM6IFtdLAogICAgICBhcHBDaGF0Rm9ybTp7CiAgICAgICAgYXBwSWQ6ICcnLAogICAgICAgIGNoYXRJZDogJycKICAgICAgfSwKICAgICAgYXBwQ2hhdFJ1bGVzOiB7CiAgICAgICAgYXBwSWQ6IFt7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nlupTnlKgnLCB0cmlnZ2VyOiAnYmx1cid9XSwKICAgICAgICBjaGF0SWQ6IFt7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6npgJrnn6XnvqTogYonLCB0cmlnZ2VyOiAnYmx1cid9XSwKICAgICAgfQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGZvcm1MYWJlbFdpZHRoKCkgewogICAgICByZXR1cm4gdmFyaWFibGVzWydmb3JtTGFiZWxXaWR0aCddCiAgICB9LAogICAgbG9hZGluZygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmxvYWRpbmcKICAgIH0sCiAgICBjaGF0T3B0aW9ucygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmNvdmVyYWdlLmxhcmtDaGF0cwogICAgfSwKICAgIHRhYmxlMkJ0bldpZHRoKCkgewogICAgICByZXR1cm4gdmFyaWFibGVzWyd0YWJsZTJCdG5XaWR0aCddCiAgICB9LAoKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldEFsbEludGxBcHBzKCkKICAgIHRoaXMuZ2V0VGFibGVEYXRhSW50bCgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRBbGxJbnRsQXBwcygpIHsKICAgICAgZGF0YVRvb2xBcGkuZ2V0QXBvbGxvSW50bEFwcHMoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5hcHBPcHRpb25zID0gcmVzLmRhdGEKICAgICAgfSkKICAgIH0sCiAgICBvcGVuRWRpdEludGwocm93KSB7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSB0cnVlCiAgICAgIHRoaXMub3BlcmF0aW9uID0gb3BlcmF0aW9uRW51bS5BREQKICAgICAgdGhpcy5hcHBDaGF0Rm9ybSA9IHsKICAgICAgICBhcHBJZDogJycsCiAgICAgICAgY2hhdElkOiAnJwogICAgICB9CiAgICAgIGlmIChyb3cpIHsKICAgICAgICB0aGlzLm9wZXJhdGlvbiA9IG9wZXJhdGlvbkVudW0uRURJVAogICAgICAgIHRoaXMuYXBwQ2hhdEZvcm0gPSBjbG9uZURlZXAocm93KQogICAgICB9CiAgICB9LAogICAgZ2V0VGFibGVEYXRhSW50bCh2YWx1ZSkgewogICAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgICAgb2Zmc2V0OiB0aGlzLnBhZ2VTaXplICogKHRoaXMuY3VycmVudFBhZ2UgLSAxKSwKICAgICAgICBsaW1pdDogdGhpcy5wYWdlU2l6ZSwKICAgICAgICBzZWFyY2g6IHZhbHVlID8gdmFsdWUgOiAnJwogICAgICB9CiAgICAgIGRhdGFUb29sQXBpLmdldEFwb2xsb0ludGxBcHBDaGF0KHBhcmFtcykudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMudGFibGVEYXRhID0gcmVzLmRhdGEuZGF0YQogICAgICAgIHRoaXMudG90YWwgPSByZXMuZGF0YS50b3RhbAogICAgICB9KQogICAgfSwKICAgIHNhdmVDb25maWdJbnRsKCkgewogICAgICBpZiAodGhpcy5vcGVyYXRpb24gPT09IG9wZXJhdGlvbkVudW0uQUREKXsKICAgICAgICBkYXRhVG9vbEFwaS5jcmVhdGVBcG9sbG9JbnRsQXBwQ2hhdCh0aGlzLmFwcENoYXRGb3JtKS5maW5hbGx5KCgpID0+IHsKICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQogICAgICAgICAgdGhpcy5nZXRUYWJsZURhdGFJbnRsKCkKICAgICAgICB9KQogICAgICB9IGVsc2UgewogICAgICAgIGRhdGFUb29sQXBpLnVwZGF0ZUFwb2xsb0ludGxBcHBDaGF0KHRoaXMuYXBwQ2hhdEZvcm0sIHRoaXMuYXBwQ2hhdEZvcm1bJ2lkJ10pLmZpbmFsbHkoKCkgPT4gewogICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICB0aGlzLmdldFRhYmxlRGF0YUludGwoKQogICAgICAgIH0pCiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVkZWxldGVJbnRsKHJvdykgewogICAgICB0aGlzLiRhbGVydCgn56Gu6K6k5Yig6Zmk6K+l6YWN572uPycsICcnLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgY2FsbGJhY2s6IChhY3Rpb24pID0+IHsKICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdjb25maXJtJykgewogICAgICAgICAgICBkYXRhVG9vbEFwaS5kZWxldGVBcG9sbG9JbnRsQXBwQ2hhdChyb3cuaWQpCiAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5nZXRUYWJsZURhdGFJbnRsKCkKICAgICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVTZWFyY2hJbnRsKHZhbHVlKSB7CiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAxCiAgICAgIHRoaXMuZ2V0VGFibGVEYXRhSW50bCh2YWx1ZSkKICAgIH0KCiAgfQp9Cg=="},{"version":3,"sources":["apolloIntlNotify.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"apolloIntlNotify.vue","sourceRoot":"src/pages/testTools","sourcesContent":["<template>\n  <div>\n    <el-card class=\"card-content\">\n      <template slot=\"header\">\n        <table-header\n          :condition=\"condition\"\n          create-tip=\"apollo通知配置-出海\"\n          placeholder=\"根据项目名称搜索\"\n          @create=\"openEditIntl\"\n          @search=\"handleSearchIntl\"\n        >\n          <template slot=\"title\">\n            <div>apolloIntl通知配置-出海</div>\n          </template>\n        </table-header>\n      </template>\n      <el-table ref=\"table\" v-loading=\"loading\" :data=\"tableData\">\n\n        <!--  项目名称  -->\n        <el-table-column label=\"应用\" prop=\"appId\"/>\n\n        <!--  群聊  -->\n        <el-table-column label=\"群聊\" prop=\"chatName\"/>\n\n        <!--  操作  -->\n        <el-table-column :width=\"table2BtnWidth\" label=\"操作\">\n          <template slot-scope=\"scope\">\n            <table-operator\n              show-delete\n              show-edit\n              @deleteClick=\"handledeleteIntl(scope.row)\"\n              @editClick=\"openEditIntl(scope.row)\"\n            />\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <table-pagination\n        :change=\"getTableDataIntl\"\n        :current-page.sync=\"currentPage\"\n        :page-size.sync=\"pageSize\"\n        :total=\"total\"\n      />\n    </el-card>\n\n    <el-dialog\n      :close-on-click-modal=\"false\"\n      :visible.sync=\"dialogFormVisible\"\n      class=\"dialog-title\"\n      width=\"65%\"\n    >\n      <template slot=\"title\">\n        <div style=\"text-align: left;\">\n          <span>{{ operation === operationEnum.EDIT? '编辑apollo通知配置' : '创建apollo通知配置' }}</span>\n        </div>\n        <el-divider style=\"width: 100%;\"></el-divider>\n      </template>\n\n      <el-form ref=\"apolloIntlNotifyForm\" :model=\"appChatForm\" :rules=\"appChatRules\" :label-width=\"formLabelWidth\">\n        <el-row>\n          <el-col :offset=\"1\" :span=\"10\">\n            <el-form-item label=\"应用\" prop=\"appId\">\n              <el-select v-model=\"appChatForm.appId\" filterable placeholder=\"请选择应用\" style=\"width: 100%\">\n                <el-option\n                  v-for=\"item in appOptions\"\n                  :key=\"item.id\"\n                  :label=\"item.appId\"\n                  :value=\"item.appId\"\n                />\n              </el-select>\n            </el-form-item>\n          </el-col>\n\n          <el-col :span=\"10\">\n            <el-form-item label=\"推送群聊\" prop=\"chatId\">\n              <el-select\n                v-model=\"appChatForm.chatId\"\n                filterable\n                placeholder=\"请选择需要通知的群\"\n                style=\"width: 100%;\"\n              >\n                <el-option\n                  v-for=\"item in chatOptions\"\n                  :key=\"item.chatId\"\n                  :label=\"item.name\"\n                  :value=\"item.chatId\"\n                />\n              </el-select>\n            </el-form-item>\n          </el-col>\n        </el-row>\n      </el-form>\n\n      <template slot=\"footer\">\n        <dialog-footer @cancel=\"dialogFormVisible = false\" @confirm=\"saveConfigIntl\"/>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport variables from \"@/assets/css/utils.scss\"\nimport {dataToolApi} from \"@/api\";\nimport {cloneDeep} from \"lodash\"\nimport TableOperator from \"@/common/components/TableOperator\";\nimport TableHeader from \"@/common/components/TableHeader\";\nimport TablePagination from \"@/common/components/pagination/TablePagination\";\nimport DialogFooter from \"@/common/components/DialogFooter\";\nimport {operationEnum} from \"@/constant/Gitlab\";\nimport {PAGINATION_SIZE} from \"@/constant\";\nexport default {\n  name: \"apolloIntlNotify\",\n  components: {\n    TableOperator,\n    TableHeader,\n    TablePagination,\n    DialogFooter,\n  },\n  data() {\n    return {\n      operationEnum: operationEnum,\n      dialogFormVisible: false,\n      condition: {},\n      operation: '',\n      tableData: [],\n      currentPage: 1,\n      pageSize: PAGINATION_SIZE.LARGE,\n      total: 0,\n      appOptions: [],\n      appChatForm:{\n        appId: '',\n        chatId: ''\n      },\n      appChatRules: {\n        appId: [{required: true, message: '请选择应用', trigger: 'blur'}],\n        chatId: [{required: true, message: '请选择通知群聊', trigger: 'blur'}],\n      }\n    }\n  },\n  computed: {\n    formLabelWidth() {\n      return variables['formLabelWidth']\n    },\n    loading() {\n      return this.$store.state.loading\n    },\n    chatOptions() {\n      return this.$store.state.coverage.larkChats\n    },\n    table2BtnWidth() {\n      return variables['table2BtnWidth']\n    },\n\n  },\n  mounted() {\n    this.getAllIntlApps()\n    this.getTableDataIntl()\n  },\n  methods: {\n    getAllIntlApps() {\n      dataToolApi.getApolloIntlApps().then(res => {\n        this.appOptions = res.data\n      })\n    },\n    openEditIntl(row) {\n      this.dialogFormVisible = true\n      this.operation = operationEnum.ADD\n      this.appChatForm = {\n        appId: '',\n        chatId: ''\n      }\n      if (row) {\n        this.operation = operationEnum.EDIT\n        this.appChatForm = cloneDeep(row)\n      }\n    },\n    getTableDataIntl(value) {\n      const params = {\n        offset: this.pageSize * (this.currentPage - 1),\n        limit: this.pageSize,\n        search: value ? value : ''\n      }\n      dataToolApi.getApolloIntlAppChat(params).then(res => {\n        this.tableData = res.data.data\n        this.total = res.data.total\n      })\n    },\n    saveConfigIntl() {\n      if (this.operation === operationEnum.ADD){\n        dataToolApi.createApolloIntlAppChat(this.appChatForm).finally(() => {\n          this.dialogFormVisible = false\n          this.getTableDataIntl()\n        })\n      } else {\n        dataToolApi.updateApolloIntlAppChat(this.appChatForm, this.appChatForm['id']).finally(() => {\n          this.dialogFormVisible = false\n          this.getTableDataIntl()\n        })\n      }\n    },\n    handledeleteIntl(row) {\n      this.$alert('确认删除该配置?', '', {\n        confirmButtonText: '确定',\n        showCancelButton: true,\n        cancelButtonText: '取消',\n        callback: (action) => {\n          if (action === 'confirm') {\n            dataToolApi.deleteApolloIntlAppChat(row.id)\n              .then(() => {\n                this.getTableDataIntl()\n              })\n          }\n        }\n      })\n    },\n    handleSearchIntl(value) {\n      this.currentPage = 1\n      this.getTableDataIntl(value)\n    }\n\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}