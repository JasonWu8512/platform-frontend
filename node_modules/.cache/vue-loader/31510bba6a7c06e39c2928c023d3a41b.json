{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/track/common/NodeEdit.vue?vue&type=style&index=0&id=efaea8f2&lang=scss&scoped=true&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/track/common/NodeEdit.vue","mtime":1655949681782},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/css-loader/dist/cjs.js","mtime":1644298105513},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1644314988580},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/@vue/cli-service/node_modules/postcss-loader/src/index.js","mtime":1644298105780},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/sass-loader/dist/cjs.js","mtime":1644314983366},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCkBpbXBvcnQgInNyYy9hc3NldHMvY3NzL3V0aWxzIjsKCi5kaWFsb2ctdGl0bGUgewogIEBleHRlbmQgJWRpYWxvZy10aXRsZTsKfQo="},{"version":3,"sources":["NodeEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;;AAEA;AACA;AACA","file":"NodeEdit.vue","sourceRoot":"src/pages/track/common","sourcesContent":["<template>\n  <el-dialog\n    :before-close=\"close\"\n    :title=\"type === operationEnum.EDIT ? '重命名' : '添加模块'\"\n    :visible.sync=\"dialogFormVisible\"\n    class=\"dialog-title\"\n    width=\"30%\"\n  >\n    <el-row justify=\"center\" type=\"flex\">\n      <el-col :span=\"18\">\n        <el-form ref=\"nodeForm\" :model=\"form\" :rules=\"rules\" @submit.native.prevent>\n          <el-form-item\n            label=\"模块名称\"\n            label-width=\"80px\"\n            prop=\"name\"\n          >\n            <el-input v-model=\"form.name\"/>\n          </el-form-item>\n        </el-form>\n      </el-col>\n    </el-row>\n    <template slot=\"footer\">\n      <dialog-footer @cancel=\"close\" @confirm=\"saveNode\"/>\n    </template>\n  </el-dialog>\n</template>\n\n<script lang=\"ts\">\nimport {testCaseApi} from \"@/api\"\nimport {RequestCreateTestCaseModules} from \"@/api/types/testTrack\"\nimport {typeNode} from \"@/api/types/testTrackType\"\nimport DialogFooter from \"@/common/components/DialogFooter.vue\"\nimport {operationEnum} from \"@/constant/TestCase\"\n\n\nexport default {\n  components: {DialogFooter},\n  data() {\n    return {\n      operationEnum: operationEnum,\n      name: \"NodeEdit\",\n      form: {\n        name: '',\n      },\n      rules: {\n        name: [\n          {required: true, message: '请输入名称', trigger: 'blur'},\n          {max: 30, message: '长度必须小于30', trigger: 'blur'}\n        ]\n      },\n      type: '',\n      node: {},\n      dialogFormVisible: false,\n    }\n  },\n  props: {\n    treeNodes: Array,\n    currentProject: Object,\n  },\n  methods: {\n    open(type: operationEnum, node: typeNode) {\n      this.type = type\n      this.node = node\n      if (type === operationEnum.EDIT) {\n        this.form.name = this.node.name\n      } else {\n        this.form.name = ''\n      }\n      this.dialogFormVisible = true\n    },\n    saveNode() {\n      this.$refs.nodeForm.validate((valid: boolean) => {\n        if (valid) {\n          if (!this.currentProject.id) {\n            this.$message.warning('暂无项目，请先创建项目')\n            return\n          }\n          if (this.form.name.trim() === '') {\n            this.$message.warning('请输入名称')\n            return\n          }\n          this.buildParam()\n        } else {\n          return false\n        }\n      })\n    },\n    buildParam() {\n      let body: RequestCreateTestCaseModules = {\n        name: this.form.name,\n        projId: this.currentProject.id\n      }\n      if (this.type === operationEnum.ADD) {\n        if (this.node) {\n          //根节点，添加需要带上父节点id\n          body = Object.assign({parent: this.node.id}, body)\n        }\n        testCaseApi.createTestCaseModules(body)\n          .then(() => {\n            this.$emit(\"refreshNode\")\n            this.close()\n          })\n      } else if (this.type === operationEnum.EDIT) {\n        testCaseApi.updateTestCaseModules(this.node.id, body)\n          .then(() => {\n            this.$emit(\"refreshNode\")\n            this.close()\n          })\n      }\n    },\n    close() {\n      this.dialogFormVisible = false\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"src/assets/css/utils\";\n\n.dialog-title {\n  @extend %dialog-title;\n}\n</style>\n"]}]}