{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/auto/AutoPointConfigList.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/auto/AutoPointConfigList.vue","mtime":1658296703985},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/ts-loader/index.js","mtime":1644314987889},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IHthdXRvQXBpfSBmcm9tICJAL2FwaSIKaW1wb3J0IFRhYmxlUGFnaW5hdGlvbiBmcm9tICJAL2NvbW1vbi9jb21wb25lbnRzL3BhZ2luYXRpb24vVGFibGVQYWdpbmF0aW9uLnZ1ZSIKaW1wb3J0IFRhYmxlSGVhZGVyIGZyb20gIkAvY29tbW9uL2NvbXBvbmVudHMvVGFibGVIZWFkZXIudnVlIgppbXBvcnQgVGFibGVPcGVyYXRvciBmcm9tICJAL2NvbW1vbi9jb21wb25lbnRzL1RhYmxlT3BlcmF0b3IudnVlIgppbXBvcnQge1BBR0lOQVRJT05fU0laRX0gZnJvbSAiQC9jb25zdGFudCIKaW1wb3J0IHtQYXRoTmFtZX0gZnJvbSAiQC9jb25zdGFudC9yb3V0ZURhdGEiCmltcG9ydCBBdXRvQ29uZmlnRWRpdCBmcm9tICJAL3BhZ2VzL2F1dG8vY29tcG9uZW50cy9BdXRvUG9pbnRDb25maWdFZGl0LnZ1ZSIKZXhwb3J0IGRlZmF1bHQgewpuYW1lOiAiQXV0b1BvaW50Q29uZmlnTGlzdCIsCiAgY29tcG9uZW50czoge1RhYmxlSGVhZGVyLCBUYWJsZVBhZ2luYXRpb24sIFRhYmxlT3BlcmF0b3IsIEF1dG9Db25maWdFZGl0fSwKICBkYXRhKCkgewogIHJldHVybiB7CiAgICBub1BvbGxpbmc6IHRydWUsCiAgICBjcmVhdGVWaXNpYmxlOiBmYWxzZSwKICAgIGNvbmRpdGlvbjoge30sCiAgICB0b3RhbDogMCwKICAgIHBhZ2VTaXplOiBQQUdJTkFUSU9OX1NJWkUuTEFSR0UsCiAgICBjdXJyZW50UGFnZTogMSwKICAgIHRhYmxlRGF0YTogW10KICB9CiAgfSwKICBjb21wdXRlZDogewogICAgbG9hZGluZygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmxvYWRpbmcKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5wb2xsaW5nRGF0YUxpc3QoKQogIH0sCiAgZGVzdHJveWVkKCkgewogICAgY2xlYXJJbnRlcnZhbCh0aGlzLm15SW50ZXJ2YWwpCiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRBdXRvQ29uZmlnTGlzdCh2YWx1ZT86IHN0cmluZykgewogICAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgICAgbGltaXQ6IHRoaXMucGFnZVNpemUsCiAgICAgICAgb2Zmc2V0OiB0aGlzLnBhZ2VTaXplICogKHRoaXMuY3VycmVudFBhZ2UgLSAxKSwKICAgICAgICBuYW1lOiB2YWx1ZSwKICAgICAgfQogICAgICBhdXRvQXBpLmdldEF1dG9DYXNlQ29uZmlnTGlzdChwYXJhbXMpLnRoZW4oIAogICAgICAgIHJlcyA9PiB7CiAgICAgICAgICB0aGlzLnRhYmxlRGF0YSA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgIHRoaXMudG90YWwgPSByZXMuZGF0YS50b3RhbAogICAgICAgICAgdGhpcy5ub1BvbGxpbmcgPSB0cnVlCiAgICAgICAgfQogICAgICApCiAgICB9LAogICAgcG9sbGluZ0RhdGFMaXN0KHZhbHVlPzogc3RyaW5nKSB7CiAgICAgIHRoaXMuZ2V0QXV0b0NvbmZpZ0xpc3QodmFsdWUpCiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5teUludGVydmFsKQogICAgICB0aGlzLm15SW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgdGhpcy5ub1BvbGxpbmcgPSBmYWxzZQogICAgICAgICAgdGhpcy5nZXRBdXRvQ29uZmlnTGlzdCh2YWx1ZSkKICAgICAgICB9LCAxKQogICAgICB9LCAzMDAwKQogICAgfSwKICAgIGhhbmRsZVBvbGxpbmdEYXRhTGlzdCh2YWx1ZT86IHN0cmluZykgewogICAgICB0aGlzLmN1cnJlbnRQYWdlID0gMQogICAgICB0aGlzLnBvbGxpbmdEYXRhTGlzdCh2YWx1ZSkKICAgIH0sCiAgICBoYW5kbGVBZGRPckVkaXQocGlwZWxpbmU/OiBhbnkpIHsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIC8vIERPTSDnjrDlnKjmm7TmlrDkuoYKICAgICAgICB0aGlzLiRyZWZzLmVkaXQub3BlbihwaXBlbGluZSkKICAgICAgfSkKICAgIH0sCiAgICAvLyDliKDpmaTmtYHmsLTnur8KICAgIGhhbmRsZURlbGV0ZShyb3c/OiBhbnkpIHsKICAgICAgdGhpcy4kYWxlcnQoJ+ehruiupOWIoOmZpOiHquWKqOWMlumFjee9rj8nLCAnJywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIGNhbGxiYWNrOiAoYWN0aW9uOiBzdHJpbmcpID0+IHsKICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdjb25maXJtJykgewogICAgICAgICAgICBhdXRvQXBpLmRlbGV0ZUF1dG9Db25maWcocm93LmlkKS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0QXV0b0NvbmZpZ0xpc3QoKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pCiAgICB9LAogICAgaGFuZGxlVG9CdWlsZFJlY29yZChyb3c/OiBhbnkpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6IFBhdGhOYW1lLkF1dG9DYXNlQnVpbGRSZWNvcmRCeUNvbmZpZ0lkLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgY29uZmlnSWQ6IHJvdy5pZAogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVSdW4ocm93PzogYW55KSB7CiAgICAgIHRoaXMuJGFsZXJ0KCfnoa7lrprmiafooYzor6Xoh6rliqjljJbnlKjkvovpm4Y/JywgJycsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICBjYWxsYmFjazogKGFjdGlvbjogc3RyaW5nKSA9PiB7CiAgICAgICAgICBpZiAoYWN0aW9uID09PSAnY29uZmlybScpIHsKICAgICAgICAgICAgYXV0b0FwaS5ydW5BdXRvQ29uZmlnKHJvdy5pZCkudGhlbigpCiAgICAgICAgICB9CiAgICAgIH0KICAgIH0pCiAgICB9CiAgfQoKfQo="},{"version":3,"sources":["AutoPointConfigList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"AutoPointConfigList.vue","sourceRoot":"src/pages/auto","sourcesContent":["<template>\n  <el-card class=\"card-content\" >\n    <template slot=\"header\">\n      <table-header :condition=\"condition\"\n                    create-tip=\"创建自动化配置\"\n                    @create=\"handleAddOrEdit\"\n                    @search=\"handlePollingDataList\" \n      >\n        <template slot=\"title\">\n          <div>埋点自动化配置</div>\n        </template>\n      </table-header>\n\n    </template>\n\n    <el-table :data=\"tableData\" size=\"medium\" v-loading=\"loading && noPolling\">\n      <el-table-column label=\"名称\" prop=\"name\"/>\n      <el-table-column label=\"执行方式\" prop=\"runMethod\"/>\n      <el-table-column label=\"创建者\" prop=\"creator\"/>\n      <el-table-column label=\"定时表达式\" prop=\"crontabSchedule\"/>\n      <el-table-column label=\"定时执行\" prop=\"enableAutoTrigger\">\n        <template v-slot:default=\"scope\">\n          <span>{{scope.row.enableAutoTrigger? '是': '否'}}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\">\n        <template slot-scope=\"scope\">\n          <table-operator\n            copy-tip=\"执行记录\"\n            show-copy\n            show-delete\n            show-edit\n            show-run\n            :run-tip=\"scope.row.status === 'running' ? '正在执行': '执行'\"\n            @copyClick=\"handleToBuildRecord(scope.row)\"\n            @deleteClick=\"handleDelete(scope.row)\"\n            @editClick=\"handleAddOrEdit(scope.row)\"\n            @runClick=\"handleRun(scope.row)\"\n            :runDisable=\"scope.row.status === 'running'\"\n          >\n          </table-operator>\n        </template>\n      </el-table-column>\n\n    </el-table>\n    <table-pagination\n      :change=\"getAutoConfigList\"\n      :current-page.sync=\"currentPage\"\n      :page-size.sync=\"pageSize\"\n      :total=\"total\"\n    />\n    <auto-config-edit ref=\"edit\" @fatherMethod=\"getAutoConfigList\"></auto-config-edit>\n\n  </el-card>\n</template>\n\n<script lang=\"ts\">\nimport {autoApi} from \"@/api\"\nimport TablePagination from \"@/common/components/pagination/TablePagination.vue\"\nimport TableHeader from \"@/common/components/TableHeader.vue\"\nimport TableOperator from \"@/common/components/TableOperator.vue\"\nimport {PAGINATION_SIZE} from \"@/constant\"\nimport {PathName} from \"@/constant/routeData\"\nimport AutoConfigEdit from \"@/pages/auto/components/AutoPointConfigEdit.vue\"\nexport default {\nname: \"AutoPointConfigList\",\n  components: {TableHeader, TablePagination, TableOperator, AutoConfigEdit},\n  data() {\n  return {\n    noPolling: true,\n    createVisible: false,\n    condition: {},\n    total: 0,\n    pageSize: PAGINATION_SIZE.LARGE,\n    currentPage: 1,\n    tableData: []\n  }\n  },\n  computed: {\n    loading() {\n      return this.$store.state.loading\n    },\n  },\n  mounted() {\n    this.pollingDataList()\n  },\n  destroyed() {\n    clearInterval(this.myInterval)\n  },\n  methods: {\n    getAutoConfigList(value?: string) {\n      const params = {\n        limit: this.pageSize,\n        offset: this.pageSize * (this.currentPage - 1),\n        name: value,\n      }\n      autoApi.getAutoCaseConfigList(params).then( \n        res => {\n          this.tableData = res.data.data\n          this.total = res.data.total\n          this.noPolling = true\n        }\n      )\n    },\n    pollingDataList(value?: string) {\n      this.getAutoConfigList(value)\n      clearInterval(this.myInterval)\n      this.myInterval = window.setInterval(() => {\n        setTimeout(() => {\n          this.noPolling = false\n          this.getAutoConfigList(value)\n        }, 1)\n      }, 3000)\n    },\n    handlePollingDataList(value?: string) {\n      this.currentPage = 1\n      this.pollingDataList(value)\n    },\n    handleAddOrEdit(pipeline?: any) {\n      this.$nextTick(function () {\n        // DOM 现在更新了\n        this.$refs.edit.open(pipeline)\n      })\n    },\n    // 删除流水线\n    handleDelete(row?: any) {\n      this.$alert('确认删除自动化配置?', '', {\n        confirmButtonText: '确定',\n        showCancelButton: true,\n        cancelButtonText: '取消',\n        callback: (action: string) => {\n          if (action === 'confirm') {\n            autoApi.deleteAutoConfig(row.id).then(() => {\n                this.getAutoConfigList()\n              }\n            )\n          }\n          }\n        })\n    },\n    handleToBuildRecord(row?: any) {\n      this.$router.push({\n        name: PathName.AutoCaseBuildRecordByConfigId,\n        params: {\n          configId: row.id\n        }\n      })\n    },\n    handleRun(row?: any) {\n      this.$alert('确定执行该自动化用例集?', '', {\n        confirmButtonText: '确定',\n        showCancelButton: true,\n        cancelButtonText: '取消',\n        callback: (action: string) => {\n          if (action === 'confirm') {\n            autoApi.runAutoConfig(row.id).then()\n          }\n      }\n    })\n    }\n  }\n\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}