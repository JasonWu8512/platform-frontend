{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/track/plan/view/comonents/TestCasePlanRun.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/track/plan/view/comonents/TestCasePlanRun.vue","mtime":1655949681804},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/ts-loader/index.js","mtime":1644314987889},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7dGVzdENhc2VBcGl9IGZyb20gIkAvYXBpIgppbXBvcnQge3R5cGVQbGFuRGF0YX0gZnJvbSAiQC9hcGkvdHlwZXMvdGVzdFBsYW5UeXBlIgppbXBvcnQge1JlcXVlc3RVcGRhdGVUZXN0Q2FzZX0gZnJvbSAiQC9hcGkvdHlwZXMvdGVzdFRyYWNrIgppbXBvcnQge3R5cGVDYXNlU3RlcH0gZnJvbSAiQC9hcGkvdHlwZXMvdGVzdFRyYWNrVHlwZSIKaW1wb3J0IHtjYXNlVHlwZUVudW0sIGNhc2VVcGRhdGVUeXBlRW51bSwgZXhlY3V0aW9uRW51bSwgc3RlcFN0YXR1c0VudW0sIHN0ZXBTdGF0dXNUeXBlfSBmcm9tICJAL2NvbnN0YW50L1Rlc3RDYXNlIgppbXBvcnQge3BsYW5SZXN1bHRFbnVtfSBmcm9tICJAL2NvbnN0YW50L1Rlc3RQbGFuIgppbXBvcnQgQ2FzZVR5cGVUYWJsZUl0ZW0gZnJvbSAiQC9wYWdlcy90cmFjay9jb21tb24vdGFibGVJdGVtcy9DYXNlVHlwZVRhYmxlSXRlbS52dWUiCmltcG9ydCBFeGVjdXRpb25UeXBlVGFibGVJdGVtIGZyb20gIkAvcGFnZXMvdHJhY2svY29tbW9uL3RhYmxlSXRlbXMvRXhlY3V0aW9uVHlwZVRhYmxlSXRlbS52dWUiCmltcG9ydCBQcmlvcml0eVRhYmxlSXRlbSBmcm9tICJAL3BhZ2VzL3RyYWNrL2NvbW1vbi90YWJsZUl0ZW1zL1ByaW9yaXR5VGFibGVJdGVtLnZ1ZSIKaW1wb3J0IFRlc3RQbGFuQ2FzZVN0YXR1c0J1dHRvbiBmcm9tICJAL3BhZ2VzL3RyYWNrL3BsYW4vY29tbW9uL1Rlc3RQbGFuQ2FzZVN0YXR1c0J1dHRvbi52dWUiCmltcG9ydCBUZXN0UmV2aWV3Q2FzZVN0ZXBTdGF0dXMgZnJvbSAiQC9wYWdlcy90cmFjay9yZXZpZXcvY29tbW9tL1Rlc3RSZXZpZXdDYXNlU3RlcFN0YXR1cy52dWUiCmltcG9ydCB7Y2xvbmVEZWVwfSBmcm9tICJsb2Rhc2giCgovLyDnlKjkvovmraXpqqTmiafooYznu5PmnpwKY29uc3Qgc3RlcFN0YXR1c09wdGlvbnMgPSBPYmplY3QuZW50cmllcyhzdGVwU3RhdHVzVHlwZSkubWFwKChbdmFsdWUsIHRleHRdKSA9PiB7CiAgcmV0dXJuIHt0ZXh0OiB0ZXh0LCB2YWx1ZTogdmFsdWV9Cn0pCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlRlc3RDYXNlUGxhblJ1biIsCiAgY29tcG9uZW50czogewogICAgUHJpb3JpdHlUYWJsZUl0ZW0sCiAgICBDYXNlVHlwZVRhYmxlSXRlbSwKICAgIEV4ZWN1dGlvblR5cGVUYWJsZUl0ZW0sCiAgICBUZXN0UGxhbkNhc2VTdGF0dXNCdXR0b24sCiAgICBUZXN0UmV2aWV3Q2FzZVN0ZXBTdGF0dXMsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2FzZVR5cGVFbnVtOiBjYXNlVHlwZUVudW0sCiAgICAgIGV4ZWN1dGlvbkVudW06IGV4ZWN1dGlvbkVudW0sCiAgICAgIHN0ZXBTdGF0dXNPcHRpb25zOiBzdGVwU3RhdHVzT3B0aW9ucywKICAgICAgc2hvd0RpYWxvZzogZmFsc2UsCiAgICAgIHRlc3RDYXNlOiB7Y2FzZURldGFpbDoge319LAogICAgICBpbmRleDogMCwKICAgICAgdG90YWw6IDAsCiAgICAgIHBhcmVudDogJycsCiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIHRlc3Q6IHt9LAogICAgICBhY3RpdmVUYWI6ICdkZXRhaWwnLAogICAgICBpc0ZhaWx1cmU6IHRydWUsCiAgICB9CiAgfSwKICBwcm9wczogewogICAgc2VhcmNoUGFyYW06IE9iamVjdCwKICAgIHBsYW5JZDogW1N0cmluZywgTnVtYmVyXSwKICB9LAogIGNvbXB1dGVkOiB7CiAgICBsb2FkaW5nKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUubG9hZGluZwogICAgfSwKICAgIG9mZnNldCgpIHsKICAgICAgcmV0dXJuIHRoaXMucGFyZW50LnBhZ2VTaXplICogKHRoaXMucGFyZW50LmN1cnJlbnRQYWdlIC0gMSkKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLiRldmVudEJ1cy4kb24oJ3Rlc3RQbGFuQ2FzZVJ1bicsICh0ZXN0Y2FzZTogdHlwZVBsYW5EYXRhLCB0YWJsZURhdGE6IHR5cGVQbGFuRGF0YVtdLCBwYXJlbnQ6IGFueSkgPT4gewogICAgICB0aGlzLnBhcmVudCA9IHBhcmVudAogICAgICB0aGlzLm9wZW4odGVzdGNhc2UsIHRhYmxlRGF0YSkKICAgIH0pCiAgfSwKICBtZXRob2RzOiB7CiAgICBjYW5jZWwoKSB7CiAgICAgIHRoaXMuc2hvd0RpYWxvZyA9IGZhbHNlCiAgICAgIHRoaXMuJGVtaXQoJ3JlZnJlc2gnKQogICAgfSwKICAgIHNhdmVDYXNlKHN0YXR1czogcGxhblJlc3VsdEVudW0pIHsKICAgICAgbGV0IGJvZHk6IFJlcXVlc3RVcGRhdGVUZXN0Q2FzZSA9IHsKICAgICAgICB0eXBlOiBjYXNlVXBkYXRlVHlwZUVudW0uVVBEQVRFX1BMQU5fU1RBVFVTLAogICAgICAgIHBsYW5JZDogdGhpcy5wbGFuSWQsCiAgICAgICAgZXhlY3V0b3I6IHRoaXMuJHN0b3JlLnN0YXRlLmxvZ2luLnVzZXJuYW1lLAogICAgICAgIHN0ZXBBY3R1YWxSZXN1bHRzOiB0aGlzLnRlc3RDYXNlLmNhc2VEZXRhaWwuc3RlcHMubWFwKChzdGVwOiB0eXBlQ2FzZVN0ZXApID0+IHsKICAgICAgICAgIHJldHVybiBzdGVwLmFjdHVhbFJlc3VsdCB8fCAnJwogICAgICAgIH0pLAogICAgICAgIHN0ZXBBY3R1YWxTdGF0dXM6IHRoaXMudGVzdENhc2UuY2FzZURldGFpbC5zdGVwcy5tYXAoKHN0ZXA6IHR5cGVDYXNlU3RlcCkgPT4gewogICAgICAgICAgcmV0dXJuIHN0ZXAuYWN0dWFsU3RhdHVzIHx8IHBsYW5SZXN1bHRFbnVtLlBBU1MKICAgICAgICB9KSwKICAgICAgICBpc3N1ZUlkczogW10sCiAgICAgIH0KICAgICAgaWYgKHRoaXMucGFyZW50LmlzUWEpIHsKICAgICAgICB0aGlzLnRlc3RDYXNlLnNtb2tlQ2hlY2sgPSBzdGF0dXMKICAgICAgICBib2R5ID0gT2JqZWN0LmFzc2lnbihib2R5LCB7CiAgICAgICAgICB0eXBlOiBjYXNlVXBkYXRlVHlwZUVudW0uVVBEQVRFX1BMQU5fU01PS0VfQ0hFQ0ssCiAgICAgICAgICBzbW9rZUNoZWNrOiBzdGF0dXMsCiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRlc3RDYXNlLnN0YXR1cyA9IHN0YXR1cwogICAgICAgIGJvZHkgPSBPYmplY3QuYXNzaWduKGJvZHksIHtzdGF0dXM6IHN0YXR1c30pCiAgICAgIH0KICAgICAgdGVzdENhc2VBcGkudXBkYXRlVGVzdENhc2UodGhpcy50ZXN0Q2FzZS5jYXNlSWQsIGJvZHkpCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy5oYW5kbGVOZXh0KCkKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoKSA9PiB7CiAgICAgICAgICB0aGlzLnBhcmVudC5pc1FhCiAgICAgICAgICAgID8gdGhpcy50ZXN0Q2FzZS5zbW9rZUNoZWNrID0gcGxhblJlc3VsdEVudW0uSU5JVAogICAgICAgICAgICA6IHRoaXMudGVzdENhc2Uuc3RhdHVzID0gcGxhblJlc3VsdEVudW0uSU5JVAogICAgICAgIH0pCiAgICB9LAogICAgYXN5bmMgaGFuZGxlTmV4dCgpIHsKICAgICAgaWYgKHRoaXMuaW5kZXggKyB0aGlzLm9mZnNldCArIDEgPT09IHRoaXMudG90YWwpIHsKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICAvLyDotoXov4flvZPliY3pobXmgLvmlbDml7bvvIzop6blj5Hnv7vpobUKICAgICAgaWYgKHRoaXMuaW5kZXggKyAxICE9PSB0aGlzLnRhYmxlRGF0YS5sZW5ndGgpIHsKICAgICAgICB0aGlzLmluZGV4KysKICAgICAgICB0aGlzLmdldFRlc3RDYXNlKHRoaXMuaW5kZXgpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHRoaXMucGFyZW50LmN1cnJlbnRQYWdlKysKICAgICAgICAgIC8vIOmHjee9ruWIl+ihqOe0ouW8lQogICAgICAgICAgdGhpcy5pbmRleCA9IC0xCiAgICAgICAgICBhd2FpdCB0aGlzLnBhcmVudC5nZXREYXRhKCkKICAgICAgICAgIHRoaXMudGFibGVEYXRhID0gdGhpcy5wYXJlbnQudGFibGVEYXRhCiAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZU5leHQoKQogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgLy8g5oGi5aSN5YiX6KGo57Si5byVCiAgICAgICAgICB0aGlzLmluZGV4ID0gdGhpcy5wYXJlbnQucGFnZVNpemUgLSAxCiAgICAgICAgICB0aGlzLnBhcmVudC5jdXJyZW50UGFnZS0tCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYXN5bmMgaGFuZGxlUHJlKCkgewogICAgICBpZiAodGhpcy5pbmRleCAhPT0gMCkgewogICAgICAgIHRoaXMuaW5kZXgtLQogICAgICAgIHRoaXMuZ2V0VGVzdENhc2UodGhpcy5pbmRleCkKICAgICAgfSBlbHNlIHsKICAgICAgICB0cnkgewogICAgICAgICAgdGhpcy5wYXJlbnQuY3VycmVudFBhZ2UtLQogICAgICAgICAgLy8g6YeN572u5YiX6KGo57Si5byVCiAgICAgICAgICB0aGlzLmluZGV4ID0gdGhpcy5wYXJlbnQucGFnZVNpemUKICAgICAgICAgIGF3YWl0IHRoaXMucGFyZW50LmdldERhdGEoKQogICAgICAgICAgdGhpcy50YWJsZURhdGEgPSB0aGlzLnBhcmVudC50YWJsZURhdGEKICAgICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlUHJlKCkKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgIC8vIOaBouWkjeWIl+ihqOe0ouW8lQogICAgICAgICAgdGhpcy5pbmRleCA9IHRoaXMucGFyZW50LnBhZ2VTaXplICsgMQogICAgICAgICAgdGhpcy5wYXJlbnQuY3VycmVudFBhZ2UrKwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGdldFRlc3RDYXNlKGluZGV4OiBudW1iZXIpIHsKICAgICAgdGhpcy50ZXN0Q2FzZSA9IHRoaXMudGFibGVEYXRhW2luZGV4XQogICAgfSwKICAgIG9wZW4odGVzdENhc2U6IHR5cGVQbGFuRGF0YSwgdGFibGVEYXRhOiB0eXBlUGxhbkRhdGFbXSkgewogICAgICB0aGlzLnNob3dEaWFsb2cgPSB0cnVlCiAgICAgIHRoaXMudG90YWwgPSB0aGlzLnBhcmVudC50b3RhbAogICAgICB0aGlzLmFjdGl2ZVRhYiA9ICdkZXRhaWwnCiAgICAgIHRoaXMudGVzdENhc2UgPSBjbG9uZURlZXAodGVzdENhc2UpCiAgICAgIHRoaXMudGFibGVEYXRhID0gdGFibGVEYXRhCiAgICAgIHRoaXMuaW5kZXggPSB0aGlzLnRhYmxlRGF0YS5pbmRleE9mKHRlc3RDYXNlKQogICAgfSwKICAgIHN0ZXBSZXN1bHRDaGFuZ2UoKSB7CiAgICAgIGlmICh0aGlzLnRlc3RDYXNlLm1ldGhvZCA9PT0gZXhlY3V0aW9uRW51bS5NQU5VQUwpIHsKICAgICAgICB0aGlzLmlzRmFpbHVyZSA9IHRoaXMudGVzdENhc2UuY2FzZURldGFpbC5zdGVwcy5maWx0ZXIoKHM6IHsgYWN0dWFsU3RhdHVzOiBzdGVwU3RhdHVzRW51bSB9KSA9PiB7CiAgICAgICAgICByZXR1cm4gcy5hY3R1YWxTdGF0dXMgPT09IHN0ZXBTdGF0dXNFbnVtLkZBSUwgfHwgcy5hY3R1YWxTdGF0dXMgPT09IHN0ZXBTdGF0dXNFbnVtLkJMT0NLCiAgICAgICAgfSkubGVuZ3RoID4gMAogICAgICB9CiAgICB9LAogIH0KfQo="},{"version":3,"sources":["TestCasePlanRun.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TestCasePlanRun.vue","sourceRoot":"src/pages/track/plan/view/comonents","sourcesContent":["<template>\n  <el-drawer\n    ref=\"drawer\"\n    :modal-append-to-body=\"false\"\n    :visible.sync=\"showDialog\"\n    :with-header=\"false\"\n    close-on-press-escape\n    size=\"100%\"\n  >\n    <el-alert\n      v-if=\"parent.isQa\"\n      :closable=\"false\"\n      center\n      effect=\"dark\"\n      title=\"当前处于测试验证模式\"\n      type=\"success\"\n    />\n\n    <el-card class=\"container\">\n\n      <el-row class=\"cast-row\">\n\n        <!--  返回按钮  -->\n        <el-col :span=\"1\">\n          <el-button icon=\"el-icon-back\" plain size=\"mini\" @click=\"cancel\">返回</el-button>\n        </el-col>\n\n        <!--  评审操作  -->\n        <el-col :span=\"22\" class=\"head-right\">\n\n          <span>上一条用例：</span>\n          <el-button\n            :disabled=\"index + offset+ 1 <= 1\"\n            :loading=\"loading\"\n            icon=\"el-icon-arrow-up\"\n            plain\n            size=\"mini\"\n            @click=\"handlePre\"\n          />\n          <span>{{ `${index + offset + 1}/${total}` }}</span>\n          <el-button\n            :disabled=\"index + offset+ 1 >= total\"\n            :loading=\"loading\"\n            icon=\"el-icon-arrow-down\"\n            plain\n            size=\"mini\"\n            @click=\"handleNext\"\n          />\n\n        </el-col>\n\n      </el-row>\n\n      <el-row>\n        <el-col>\n          <el-divider content-position=\"left\">{{ testCase.caseDetail.name }}</el-divider>\n        </el-col>\n      </el-row>\n\n      <el-row class=\"cast-row\">\n        <el-col :offset=\"1\" :span=\"4\">\n          <span class=\"cast-label\">用例等级：</span>\n          <priority-table-item :value=\"testCase.caseDetail.importance\" text/>\n        </el-col>\n        <el-col :span=\"5\">\n          <span class=\"cast-label\">用例类型：</span>\n          <case-type-table-item :value=\"testCase.caseDetail.caseType\"/>\n        </el-col>\n        <el-col :span=\"10\">\n          <test-plan-case-status-button\n            v-if=\"parent.isQa\"\n            :status=\"testCase.smokeCheck\"\n            @statusChange=\"saveCase\"\n          />\n          <test-plan-case-status-button v-else :status=\"testCase.status\" @statusChange=\"saveCase\"/>\n        </el-col>\n      </el-row>\n\n      <el-row class=\"cast-row\">\n        <el-col :offset=\"1\" :span=\"4\">\n          <span class=\"cast-label\">测试方式：</span>\n          <execution-type-table-item :value=\"testCase.caseDetail.executionType\"/>\n        </el-col>\n        <el-col :span=\"5\">\n          <span class=\"cast-label\">所属模块：</span>\n          <span>{{ testCase.treePath }}</span>\n        </el-col>\n        <el-col :span=\"4\">\n          <span class=\"cast-label\">所属项目：</span>\n          <span>{{ testCase.projName }}</span>\n        </el-col>\n      </el-row>\n\n      <el-row class=\"cast-row\">\n        <el-col :offset=\"1\">\n          <span class=\"cast-label\">前置条件：</span>\n          <span>{{ testCase.caseDetail.preconditions }}</span>\n        </el-col>\n      </el-row>\n\n      <el-row v-if=\"testCase.method === executionEnum.AUTO && testCase.testId\" class=\"cast-row\">\n        <el-col :offset=\"1\" :span=\"20\" class=\"test-detail\">\n          <el-tabs v-model=\"activeTab\" type=\"border-card\">\n            <el-tab-pane label=\"测试详情\" name=\"detail\">\n              <api-test-detail\n                v-if=\"testCase.caseType === caseTypeEnum.API\"\n                :id=\"testCase.testId\"\n                ref=\"apiTestDetail\"\n                :is-read-only=\"true\"\n              />\n              <performance-test-detail\n                v-else-if=\"testCase.caseType === caseTypeEnum.PERFORMANCE\"\n                :id=\"testCase.testId\"\n                ref=\"performanceTestDetail\"\n                :is-read-only=\"true\"\n              />\n            </el-tab-pane>\n          </el-tabs>\n        </el-col>\n      </el-row>\n\n      <el-row v-if=\"testCase.executionType !== executionEnum.AUTO\" class=\"cast-row\">\n        <el-col :offset=\"1\" :span=\"21\">\n          <div class=\"cast-label\">执行步骤：</div>\n          <el-table\n            :border=\"true\"\n            :data=\"testCase.caseDetail.steps\"\n            :default-sort=\"{prop: 'num', order: 'ascending'}\"\n            class=\"tb-edit\"\n            highlight-current-row\n            size=\"mini\"\n          >\n            <el-table-column label=\"编号\" min-width=\"5%\" prop=\"stepNumber\"/>\n\n            <el-table-column label=\"步骤描述\" min-width=\"21%\" prop=\"actions\">\n              <template slot-scope=\"scope\">\n                <el-input\n                  v-model=\"scope.row.actions\"\n                  :autosize=\"{ minRows: 1, maxRows: 4}\"\n                  :disabled=\"true\"\n                  class=\"border-hidden\"\n                  size=\"mini\"\n                  type=\"textarea\"\n                />\n              </template>\n            </el-table-column>\n            <el-table-column label=\"预期结果\" min-width=\"21%\" prop=\"expectedresults\">\n              <template slot-scope=\"scope\">\n                <el-input\n                  v-model=\"scope.row.expectedresults\"\n                  :autosize=\"{ minRows: 1, maxRows: 4}\"\n                  class=\"border-hidden\"\n                  disabled\n                  size=\"mini\"\n                  type=\"textarea\"\n                />\n              </template>\n            </el-table-column>\n            <el-table-column label=\"实际结果\" min-width=\"21%\">\n              <template slot-scope=\"scope\">\n                <el-input\n                  v-model=\"scope.row.actualResult\"\n                  :autosize=\"{ minRows: 2, maxRows: 4}\"\n                  :rows=\"2\"\n                  class=\"table-edit-input\"\n                  clearable\n                  placeholder=\"请输入内容\"\n                  size=\"mini\"\n                  type=\"textarea\"\n                />\n              </template>\n            </el-table-column>\n            <el-table-column label=\"步骤执行结果\" min-width=\"12%\">\n              <template slot-scope=\"scope\">\n                <el-select\n                  v-model=\"scope.row.actualStatus\"\n                  size=\"mini\"\n                  @change=\"stepResultChange()\"\n                >\n                  <el-option\n                    v-for=\"item in stepStatusOptions\"\n                    :key=\"item.value\"\n                    :label=\"item.text\"\n                    :value=\"item.value\"\n                  >\n                    <test-review-case-step-status :value=\"item.value\"/>\n                  </el-option>\n                </el-select>\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-col>\n      </el-row>\n\n      <el-row class=\"cast-row\">\n        <el-col :offset=\"1\" :span=\"15\">\n          <div>\n            <span class=\"cast-label\">备注：</span>\n            <span v-if=\"!testCase.description\" style=\"color: darkgrey\">未填写</span>\n          </div>\n          <div>\n            <el-input\n              v-if=\"testCase.description\"\n              v-model=\"testCase.description\"\n              :rows=\"3\"\n              disabled\n              type=\"textarea\"\n            />\n          </div>\n        </el-col>\n      </el-row>\n    </el-card>\n\n  </el-drawer>\n</template>\n\n<script lang=\"ts\">\nimport {testCaseApi} from \"@/api\"\nimport {typePlanData} from \"@/api/types/testPlanType\"\nimport {RequestUpdateTestCase} from \"@/api/types/testTrack\"\nimport {typeCaseStep} from \"@/api/types/testTrackType\"\nimport {caseTypeEnum, caseUpdateTypeEnum, executionEnum, stepStatusEnum, stepStatusType} from \"@/constant/TestCase\"\nimport {planResultEnum} from \"@/constant/TestPlan\"\nimport CaseTypeTableItem from \"@/pages/track/common/tableItems/CaseTypeTableItem.vue\"\nimport ExecutionTypeTableItem from \"@/pages/track/common/tableItems/ExecutionTypeTableItem.vue\"\nimport PriorityTableItem from \"@/pages/track/common/tableItems/PriorityTableItem.vue\"\nimport TestPlanCaseStatusButton from \"@/pages/track/plan/common/TestPlanCaseStatusButton.vue\"\nimport TestReviewCaseStepStatus from \"@/pages/track/review/commom/TestReviewCaseStepStatus.vue\"\nimport {cloneDeep} from \"lodash\"\n\n// 用例步骤执行结果\nconst stepStatusOptions = Object.entries(stepStatusType).map(([value, text]) => {\n  return {text: text, value: value}\n})\n\nexport default {\n  name: \"TestCasePlanRun\",\n  components: {\n    PriorityTableItem,\n    CaseTypeTableItem,\n    ExecutionTypeTableItem,\n    TestPlanCaseStatusButton,\n    TestReviewCaseStepStatus,\n  },\n  data() {\n    return {\n      caseTypeEnum: caseTypeEnum,\n      executionEnum: executionEnum,\n      stepStatusOptions: stepStatusOptions,\n      showDialog: false,\n      testCase: {caseDetail: {}},\n      index: 0,\n      total: 0,\n      parent: '',\n      tableData: [],\n      test: {},\n      activeTab: 'detail',\n      isFailure: true,\n    }\n  },\n  props: {\n    searchParam: Object,\n    planId: [String, Number],\n  },\n  computed: {\n    loading() {\n      return this.$store.state.loading\n    },\n    offset() {\n      return this.parent.pageSize * (this.parent.currentPage - 1)\n    }\n  },\n  mounted() {\n    this.$eventBus.$on('testPlanCaseRun', (testcase: typePlanData, tableData: typePlanData[], parent: any) => {\n      this.parent = parent\n      this.open(testcase, tableData)\n    })\n  },\n  methods: {\n    cancel() {\n      this.showDialog = false\n      this.$emit('refresh')\n    },\n    saveCase(status: planResultEnum) {\n      let body: RequestUpdateTestCase = {\n        type: caseUpdateTypeEnum.UPDATE_PLAN_STATUS,\n        planId: this.planId,\n        executor: this.$store.state.login.username,\n        stepActualResults: this.testCase.caseDetail.steps.map((step: typeCaseStep) => {\n          return step.actualResult || ''\n        }),\n        stepActualStatus: this.testCase.caseDetail.steps.map((step: typeCaseStep) => {\n          return step.actualStatus || planResultEnum.PASS\n        }),\n        issueIds: [],\n      }\n      if (this.parent.isQa) {\n        this.testCase.smokeCheck = status\n        body = Object.assign(body, {\n          type: caseUpdateTypeEnum.UPDATE_PLAN_SMOKE_CHECK,\n          smokeCheck: status,\n        })\n      } else {\n        this.testCase.status = status\n        body = Object.assign(body, {status: status})\n      }\n      testCaseApi.updateTestCase(this.testCase.caseId, body)\n        .then(() => {\n          this.handleNext()\n        })\n        .catch(() => {\n          this.parent.isQa\n            ? this.testCase.smokeCheck = planResultEnum.INIT\n            : this.testCase.status = planResultEnum.INIT\n        })\n    },\n    async handleNext() {\n      if (this.index + this.offset + 1 === this.total) {\n        return\n      }\n      // 超过当前页总数时，触发翻页\n      if (this.index + 1 !== this.tableData.length) {\n        this.index++\n        this.getTestCase(this.index)\n      } else {\n        try {\n          this.parent.currentPage++\n          // 重置列表索引\n          this.index = -1\n          await this.parent.getData()\n          this.tableData = this.parent.tableData\n          await this.handleNext()\n        } catch {\n          // 恢复列表索引\n          this.index = this.parent.pageSize - 1\n          this.parent.currentPage--\n        }\n      }\n    },\n    async handlePre() {\n      if (this.index !== 0) {\n        this.index--\n        this.getTestCase(this.index)\n      } else {\n        try {\n          this.parent.currentPage--\n          // 重置列表索引\n          this.index = this.parent.pageSize\n          await this.parent.getData()\n          this.tableData = this.parent.tableData\n          await this.handlePre()\n        } catch {\n          // 恢复列表索引\n          this.index = this.parent.pageSize + 1\n          this.parent.currentPage++\n        }\n      }\n    },\n    getTestCase(index: number) {\n      this.testCase = this.tableData[index]\n    },\n    open(testCase: typePlanData, tableData: typePlanData[]) {\n      this.showDialog = true\n      this.total = this.parent.total\n      this.activeTab = 'detail'\n      this.testCase = cloneDeep(testCase)\n      this.tableData = tableData\n      this.index = this.tableData.indexOf(testCase)\n    },\n    stepResultChange() {\n      if (this.testCase.method === executionEnum.MANUAL) {\n        this.isFailure = this.testCase.caseDetail.steps.filter((s: { actualStatus: stepStatusEnum }) => {\n          return s.actualStatus === stepStatusEnum.FAIL || s.actualStatus === stepStatusEnum.BLOCK\n        }).length > 0\n      }\n    },\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.cast-row {\n  text-align: left;\n}\n\n.border-hidden > > > .el-textarea__inner {\n  border-style: hidden;\n  background-color: white;\n  color: #606266;\n}\n\n.cast-label {\n  color: dimgray;\n}\n\n.status-button {\n  padding-left: 4%;\n}\n\n.head-right {\n  text-align: right;\n}\n\n.el-col:not(.test-detail) {\n  line-height: 50px;\n}\n\n.issues-edit > > > p {\n  line-height: 16px;\n}\n\n.status-button {\n  float: right;\n}\n\n.head-right-tip {\n  color: darkgrey;\n}\n\n.el-scrollbar {\n  height: 100%;\n}\n\n.container {\n  height: 100%;\n  margin: 15px;\n}\n\n.el-switch > > > .el-switch__label {\n  color: dimgray;\n}\n\n.el-switch > > > .el-switch__label.is-active {\n  color: #409EFF;\n}\n\n.container > > > .el-card__body {\n  height: calc(100vh - 70px);\n}\n\n.el-divider__text {\n  text-align: left;\n  line-height: normal;\n}\n\n</style>\n\n<style lang=\"scss\">\n.el-drawer.rtl {\n  overflow: auto;\n}\n</style>\n"]}]}