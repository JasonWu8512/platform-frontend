{"remainingRequest":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jlglqa/Documents/QA/noa/src/pages/jira/VersionReport.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jlglqa/Documents/QA/noa/src/pages/jira/VersionReport.vue","mtime":1655949681777},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/babel-loader/lib/index.js","mtime":1644314985388},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/cache-loader/dist/cjs.js","mtime":1644298102062},{"path":"/Users/jlglqa/Documents/QA/noa/node_modules/vue-loader/lib/index.js","mtime":1644314988580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBqaXJhQXBpIGZyb20gIkAvYXBpL2ppcmEiCmltcG9ydCBub0RhdGEgZnJvbSAiQC9jb21tb24vY29tcG9uZW50cy9ub0RhdGEudnVlIgppbXBvcnQgdmVyc2lvblF1YWxpdHlSZXBvcnQgZnJvbSAiQC9wYWdlcy9qaXJhL3ZlcnNpb25RdWFsaXR5UmVwb3J0LnZ1ZSIKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiVmVyc2lvblJlcG9ydCIsCiAgY29tcG9uZW50czogewogICAgdmVyc2lvblF1YWxpdHlSZXBvcnQsCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgdnVlL25vLXVudXNlZC1jb21wb25lbnRzCiAgICBub0RhdGEsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYWN0aXZlUGFubmVsOiAndmVyc2lvbkVzdGltYXRlUmVwb3J0JywKICAgICAgb3B0aW9uUHJvcHM6IHsKICAgICAgICB2YWx1ZTogJ2lkJywKICAgICAgICBsYWJlbDogJ25hbWUnLAogICAgICAgIGNoaWxkcmVuOiAnc3ByaW50cycKICAgICAgfSwKICAgICAgc3BWYWx1ZXM6IFtdLAogICAgICBjb2x1bW5zUGFyZW50OiBbewogICAgICAgIGxhYmVsOiAn5oyH5rS+5Lq6JywKICAgICAgICBwcm9wczogJ2J1Z093bmVyJywKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogJ+exu+WeiycsCiAgICAgICAgICBwcm9wczogJ3R5cGUnLAogICAgICAgICAgc29ydGFibGU6IGZhbHNlLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbGFiZWw6ICfku7vliqFpZCcsCiAgICAgICAgICBwcm9wczogJ2tleScsCiAgICAgICAgICBzb3J0YWJsZTogZmFsc2UsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogJ+aJgOWxnnN0b3J5JywKICAgICAgICAgIHByb3BzOiAncGFyZW50S2V5JywKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogJ+eKtuaAgScsCiAgICAgICAgICBwcm9wczogJ3N0YXR1cycsCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICB9LCB7CiAgICAgICAgICBsYWJlbDogJ+W3peS9nOmHjyjlpKkpJywKICAgICAgICAgIHByb3BzOiAnZGF5JywKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfV0sCiAgICAgIGNvbHVtbnNDaGlsZDogW10sCiAgICAgIHZlcnNpb25zRXN0aW1hdGU6IFtdLAogICAgICB2ZXJzaW9uc1F1YWxpdHk6IFtdLAogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHByb2plY3RTcHJpbnRzKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuamlyYS5wcm9qZWN0czsKICAgIH0sCiAgICBzcHJpbnRJZCgpIHsKICAgICAgaWYgKHRoaXMuc3BWYWx1ZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHZ1ZS9uby1hc3luYy1pbi1jb21wdXRlZC1wcm9wZXJ0aWVzCiAgICAgICAgamlyYUFwaS5nZXRMYXRlc3RTcHJpbnQoe30pLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHRoaXMuc3BWYWx1ZXMgPSBbcmVzLmRhdGEucHJvaklkLCByZXMuZGF0YS5pZF0KICAgICAgICAgIC8vIHRoaXMuZ2V0VmVyc2lvbnNSZXBvcnQodGhpcy5zcFZhbHVlc1sxXSkKICAgICAgICB9KQogICAgICB9CiAgICAgIHJldHVybiB0aGlzLnNwVmFsdWVzWzFdCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgc3ByaW50SWQoKSB7CiAgICAgIHRoaXMuZ2V0VmVyc2lvbnNSZXBvcnQoKQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgY2VsbFN0eWxlKCl7CiAgICAgIHJldHVybiAnZm9udDogMTNweCBBcmlhbDtmb250LXdlaWdodDogNTAwOyBjb2xvcjogIzYwNjI2NjsnCiAgICB9LAogICAgZ2V0VmVyc2lvbnNSZXBvcnQoKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCdzcFZhbHVlcycsIHRoaXMuc3BWYWx1ZXMpCiAgICAgIGppcmFBcGkuZ2V0VmVyc2lvbkRldGFpbHNCeVNwcmludCh7c3ByaW50SWQ6IHRoaXMuc3ByaW50SWQsIHR5cGU6ICdub0J1Zyd9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy52ZXJzaW9uc0VzdGltYXRlID0gcmVzLmRhdGEuZGF0YXMubWFwKHZlcnNpb24gPT4gewogICAgICAgICAgdmFyIGRldGFpbHMgPSB2ZXJzaW9uLmRldGFpbHMubWFwKGRldGFpbCA9PiB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgYnVnT3duZXI6IGRldGFpbC5idWdPd25lciwKICAgICAgICAgICAgICBpZDogZGV0YWlsLmJ1Z093bmVyLAogICAgICAgICAgICAgIHR5cGU6ICflkIjorqEnLAogICAgICAgICAgICAgIHN0YXR1czogJycsCiAgICAgICAgICAgICAgZGF5OiBkZXRhaWwuZGF5LAogICAgICAgICAgICAgIHRhc2tzOiBkZXRhaWwudGFza3MsCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB2ZXJzaW9uOiB2ZXJzaW9uLnZlcnNpb24sCiAgICAgICAgICAgIGRldGFpbHM6IGRldGFpbHMKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9KQogICAgICBqaXJhQXBpLmdldFZlcnNpb25EZXRhaWxzQnlTcHJpbnQoe3NwcmludElkOiB0aGlzLnNwcmludElkLCB0eXBlOiAnQnVnJ30pLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLnZlcnNpb25zUXVhbGl0eSA9IHJlcy5kYXRhLmRhdGFzLm1hcCh2ZXJzaW9uID0+IHsKICAgICAgICAgIHZhciBkZXRhaWxzID0gdmVyc2lvbi5kZXRhaWxzLm1hcChkZXRhaWwgPT4gewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGJ1Z093bmVyOiBkZXRhaWwuYnVnT3duZXIsCiAgICAgICAgICAgICAgYnVn5pWwOiBkZXRhaWwudGFza3MubGVuZ3RoLAogICAgICAgICAgICAgIOe6v+S4i2J1Z+WIhjogZGV0YWlsLm9mZmxpbmVQb2ludCwKICAgICAgICAgICAgICDnur/kuIpidWfliIY6IGRldGFpbC5vbmxpbmVQb2ludCwKICAgICAgICAgICAgICDkurrlpKlidWfnjoc6IGRldGFpbC5kYXkgPyAoZGV0YWlsLnRhc2tzLmxlbmd0aCAvIGRldGFpbC5kYXkpLnRvRml4ZWQoMikgOiAwLAogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdmVyc2lvbjogdmVyc2lvbi52ZXJzaW9uLAogICAgICAgICAgICBjaGFydERhdGE6IHsKICAgICAgICAgICAgICByb3dzOiBkZXRhaWxzLAogICAgICAgICAgICAgIGNvbHVtbnM6IFsnYnVnT3duZXInLCAnYnVn5pWwJywgJ+e6v+S4i2J1Z+WIhicsICfnur/kuIpidWfliIYnLCAn5Lq65aSpYnVn546HJ10sCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSkKICAgIH0sCiAgICB0YWJsZVJvd0NsYXNzTmFtZShyb3cpIHsKICAgICAgLy8gY29uc29sZS5sb2coJ3JvdycsIHJvdykKICAgICAgaWYgKHJvdy5yb3cudHlwZSA9PT0gJ0J1ZycpIHsKICAgICAgICByZXR1cm4gJ2J1Zy1yb3cnOwogICAgICB9IGVsc2UgaWYgKHJvdy5yb3cudHlwZSA9PT0gJ1N1Yi10YXNrJykgewogICAgICAgIHJldHVybiAndGFzay1yb3cnOwogICAgICB9IGVsc2UgaWYgKHJvdy5yb3cudHlwZSA9PT0gJ1Rhc2snKSB7CiAgICAgICAgcmV0dXJuICd0YXNrLXJvdycKICAgICAgfSBlbHNlIGlmIChyb3cucm93LnR5cGUgPT09ICdTdG9yeScpIHsKICAgICAgICByZXR1cm4gJ3N0b3J5LXJvdycKICAgICAgfQogICAgICByZXR1cm4gJyc7CiAgICB9LAogICAgdHlwZUljb24odHlwZSkgewogICAgICBpZiAodHlwZSA9PT0gJ0J1ZycpIHsKICAgICAgICByZXR1cm4gcmVxdWlyZSgnLi4vLi4vYXNzZXRzL2ltZy9qaXJhX2J1Zy5zdmcnKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnU3ViLXRhc2snKSB7CiAgICAgICAgcmV0dXJuIHJlcXVpcmUoJy4uLy4uL2Fzc2V0cy9pbWcvamlyYV9zdWJ0YXNrLnN2ZycpOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdUYXNrJykgewogICAgICAgIHJldHVybiByZXF1aXJlKCcuLi8uLi9hc3NldHMvaW1nL2ppcmFfdGFzay5zdmcnKQogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdTdG9yeScpIHsKICAgICAgICByZXR1cm4gcmVxdWlyZSgnLi4vLi4vYXNzZXRzL2ltZy9qaXJhX3N0b3J5LnN2ZycpCiAgICAgIH0KICAgICAgcmV0dXJuICcnOwoKICAgIH0KCiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIC8vIHRoaXMuZ2V0VmVyc2lvbnNSZXBvcnQoKTsKICB9Cn0K"},{"version":3,"sources":["VersionReport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA","file":"VersionReport.vue","sourceRoot":"src/pages/jira","sourcesContent":["<template>\n  <el-card shadow=\"never\">\n    <div style=\"position: relative\">\n      <el-tabs v-model=\"activePannel\" :before-leave=\"getVersionsReport\">\n        <el-tab-pane label=\"人员工作量报告\" name=\"versionEstimateReport\">\n\n          <div\n            v-for=\"(version, index) in versionsEstimate\"\n            :key=\"index\"\n            :index=\"index\"\n            :version=\"version\"\n            style=\"margin-top: 20px;\"\n          >\n            <el-card :body-style=\"{ padding: '0px' }\">\n              <div\n                style=\"font-size: 14px; font-weight: 600; height: 40px; color: #fff;background-color:#2c2a48;  text-align: left;line-height: 40px; padding-left: 10px\">\n                <span>{{ version.version }}</span>\n              </div>\n              <el-table\n                :data=\"version['details']\"\n                :row-class-name=\"tableRowClassName\"\n                :cell-style=\"cellStyle\"\n                :tree-props=\"{children: 'tasks'}\"\n                row-key=\"id\"\n                size=\"medium\"\n              >\n                <template v-for=\"col in columnsParent\">\n                  <el-table-column :key=\"col.props\" :label=\"col.label\" :prop=\"col.props\" :sortable=\"col.sortable\">\n                    <template slot-scope=\"scope\" style=\" vertical-align: text-bottom\">\n                      <img v-if=\"col.props === 'type'\" :src=\"typeIcon(scope.row.type)\"\n                           alt style=\"width: 12px; height: 12px;\">\n                      <span>{{ scope.row[col.props] }}</span>\n                    </template>\n                  </el-table-column>\n                </template>\n              </el-table>\n            </el-card>\n          </div>\n        </el-tab-pane>\n        <el-tab-pane label=\"人员质量报告\" name=\"versioQualityReport\">\n          <version-quality-report :active-name=\"activePannel\" :versions.sync=\"versionsQuality\"></version-quality-report>\n        </el-tab-pane>\n\n      </el-tabs>\n      <div class=\"cur_project\">\n        <el-cascader v-model=\"spValues\" :options=\"projectSprints\" :props=\"optionProps\" placeholder=\"请选择项目->迭代\"\n                     size=\"mini\" style=\"width: 300px\"></el-cascader>\n      </div>\n    </div>\n\n  </el-card>\n\n\n</template>\n\n<script>\nimport jiraApi from \"@/api/jira\"\nimport noData from \"@/common/components/noData.vue\"\nimport versionQualityReport from \"@/pages/jira/versionQualityReport.vue\"\n\nexport default {\n  name: \"VersionReport\",\n  components: {\n    versionQualityReport,\n    // eslint-disable-next-line vue/no-unused-components\n    noData,\n  },\n  data() {\n    return {\n      activePannel: 'versionEstimateReport',\n      optionProps: {\n        value: 'id',\n        label: 'name',\n        children: 'sprints'\n      },\n      spValues: [],\n      columnsParent: [{\n        label: '指派人',\n        props: 'bugOwner',\n        sortable: true,\n      },\n        {\n          label: '类型',\n          props: 'type',\n          sortable: false,\n        },\n        {\n          label: '任务id',\n          props: 'key',\n          sortable: false,\n        },\n        {\n          label: '所属story',\n          props: 'parentKey',\n          sortable: true\n        },\n        {\n          label: '状态',\n          props: 'status',\n          sortable: true,\n        }, {\n          label: '工作量(天)',\n          props: 'day',\n          sortable: true\n        }],\n      columnsChild: [],\n      versionsEstimate: [],\n      versionsQuality: [],\n    }\n  },\n  computed: {\n    projectSprints() {\n      return this.$store.state.jira.projects;\n    },\n    sprintId() {\n      if (this.spValues.length === 0) {\n        // eslint-disable-next-line vue/no-async-in-computed-properties\n        jiraApi.getLatestSprint({}).then(res => {\n          this.spValues = [res.data.projId, res.data.id]\n          // this.getVersionsReport(this.spValues[1])\n        })\n      }\n      return this.spValues[1]\n    }\n  },\n  watch: {\n    sprintId() {\n      this.getVersionsReport()\n    }\n  },\n  methods: {\n    cellStyle(){\n      return 'font: 13px Arial;font-weight: 500; color: #606266;'\n    },\n    getVersionsReport() {\n      // console.log('spValues', this.spValues)\n      jiraApi.getVersionDetailsBySprint({sprintId: this.sprintId, type: 'noBug'}).then(res => {\n        this.versionsEstimate = res.data.datas.map(version => {\n          var details = version.details.map(detail => {\n            return {\n              bugOwner: detail.bugOwner,\n              id: detail.bugOwner,\n              type: '合计',\n              status: '',\n              day: detail.day,\n              tasks: detail.tasks,\n            }\n          })\n          return {\n            version: version.version,\n            details: details\n          }\n        })\n      })\n      jiraApi.getVersionDetailsBySprint({sprintId: this.sprintId, type: 'Bug'}).then(res => {\n        this.versionsQuality = res.data.datas.map(version => {\n          var details = version.details.map(detail => {\n            return {\n              bugOwner: detail.bugOwner,\n              bug数: detail.tasks.length,\n              线下bug分: detail.offlinePoint,\n              线上bug分: detail.onlinePoint,\n              人天bug率: detail.day ? (detail.tasks.length / detail.day).toFixed(2) : 0,\n            }\n          })\n          return {\n            version: version.version,\n            chartData: {\n              rows: details,\n              columns: ['bugOwner', 'bug数', '线下bug分', '线上bug分', '人天bug率'],\n            },\n          }\n        })\n      })\n    },\n    tableRowClassName(row) {\n      // console.log('row', row)\n      if (row.row.type === 'Bug') {\n        return 'bug-row';\n      } else if (row.row.type === 'Sub-task') {\n        return 'task-row';\n      } else if (row.row.type === 'Task') {\n        return 'task-row'\n      } else if (row.row.type === 'Story') {\n        return 'story-row'\n      }\n      return '';\n    },\n    typeIcon(type) {\n      if (type === 'Bug') {\n        return require('../../assets/img/jira_bug.svg');\n      } else if (type === 'Sub-task') {\n        return require('../../assets/img/jira_subtask.svg');\n      } else if (type === 'Task') {\n        return require('../../assets/img/jira_task.svg')\n      } else if (type === 'Story') {\n        return require('../../assets/img/jira_story.svg')\n      }\n      return '';\n\n    }\n\n  },\n\n  mounted() {\n    // this.getVersionsReport();\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n\n\n</style>\n<style lang=\"scss\">\n.el-cascader-panel {\n  font-size: 12px !important;\n}\n.el-cascader__suggestion-list{\n  font-size: 12px !important;\n}\n\n.cur_project {\n  position: absolute;\n  right: 10px;\n  top: 2px\n}\n\ndiv.sticky {\n  position: -webkit-sticky;\n  position: sticky;\n  top: 0;\n  background-color: #fff;\n}\n\n.el-table .bug-row {\n  background: #fde2e2;\n}\n\n.el-table .task-row {\n  background: #b3d8ff;\n}\n\n.el-table .story-row {\n  background: #e0f0d5;\n}\n\n</style>\n"]}]}